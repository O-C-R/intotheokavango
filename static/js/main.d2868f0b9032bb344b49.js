webpackJsonp([1],{0:function(module,exports,__webpack_require__){module.exports=__webpack_require__(471)},67:function(module,exports){"use strict";function validateDate(d){return"[object Date]"===Object.prototype.toString.call(d)&&!isNaN(d.getTime())}function parseDate(d){if(validateDate(d))return d;var dd=new Date(d);if(validateDate(dd))return dd;if(dd=d.slice(0,-2).split(/[^0-9]/),d=new Date(Date.UTC(dd[0],dd[1]-1,dd[2],dd[3],dd[4],dd[5])-36e5*dd[6]),validateDate(d))return d;throw d}function dateToString(d,short){var month=d.getUTCMonth()+1,day=d.getUTCDate(),hour=d.getUTCHours()+"";1===hour.length&&(hour="0"+hour);var minute=d.getUTCMinutes()+"";1===minute.length&&(minute="0"+minute);var monthString="";return 1===month&&(monthString="January"),2===month&&(monthString="February"),3===month&&(monthString="March"),4===month&&(monthString="April"),5===month&&(monthString="May"),6===month&&(monthString="June"),7===month&&(monthString="July"),8===month&&(monthString="August"),9===month&&(monthString="September"),10===month&&(monthString="October"),11===month&&(monthString="November"),12===month&&(monthString="December"),short&&(monthString=monthString.slice(0,3)),monthString+" "+day+", "+hour+":"+minute}function lerp(start,end,ratio){return start+(end-start)*ratio}function rgb2hex(rgb){return(255*rgb[0]<<16)+(255*rgb[1]<<8)+255*rgb[2]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseDate=parseDate,exports.dateToString=dateToString,exports.lerp=lerp,exports.rgb2hex=rgb2hex},116:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function timestampToString(t){var d=new Date(t),year=d.getUTCFullYear(),month=d.getUTCMonth()+1+"";1===month.length&&(month="0"+month);var date=d.getUTCDate()+"";return 1===date.length&&(date="0"+date),year+"-"+month+"-"+date}function closeLightBox(){return{type:CLOSE_LIGHTBOX}}function show360Picture(post){return{type:SHOW_360_PICTURE,post:post}}function enableContent(){return{type:ENABLE_CONTENT}}function setPage(){return function(dispatch,getState){dispatch({type:SET_PAGE,location:location.pathname}),"/journal"===location.pathname&&dispatch(checkFeedContent())}}function checkFeedContent(){return function(dispatch,getState){var state=getState(),expeditionID=state.selectedExpedition,expedition=state.expeditions[expeditionID],dayCount=expedition.dayCount,posts=d3.values(expedition.features),postsByDay=expedition.postsByDay,contentHeight=d3.select("#content").node().offsetHeight,scrollTop=d3.select("#content").node().scrollTop,feedElement=d3.select("#feed").node(),viewRange=[scrollTop,scrollTop+contentHeight];if(feedElement){var postElements=d3.select(feedElement).selectAll("div.post")._groups[0],visibleDays=[],visibleElements=[];postElements&&postElements.forEach(function(p){var postRange=[p.offsetTop-100,p.offsetTop+p.offsetHeight-100];(viewRange[0]>postRange[0]&&viewRange[0]<=postRange[1]||viewRange[0]<=postRange[0]&&viewRange[1]>postRange[0]||viewRange[1]>postRange[0]&&viewRange[1]<=postRange[1])&&visibleElements.push(p.className.split(" ")[1])}),visibleElements.forEach(function(p){var feature=expedition.features[p];if(feature){var day=Math.floor(((0,_utils.parseDate)(feature.properties.DateTime).getTime()-expedition.start.getTime())/864e5);visibleDays.indexOf(day)===-1&&visibleDays.push(day)}});for(var i=0;i<visibleDays.length-1;i++)if(Math.abs(visibleDays[i]-visibleDays[i+1])){dispatch(fetchPostsByDay(expeditionID,null,i));break}var feedHeight=feedElement.offsetHeight;(0===posts.length||feedHeight<contentHeight||scrollTop<=100&&!postsByDay[dayCount]||scrollTop>=feedHeight-contentHeight-100&&!postsByDay[0])&&dispatch(fetchPostsByDay(expeditionID,expedition.currentDate))}else(0===posts.length||scrollTop<=100&&!postsByDay[dayCount])&&dispatch(fetchPostsByDay(expeditionID,expedition.currentDate))}}function fetchPostsByDay(_expeditionID,date,expeditionDay){return function(dispatch,getState){var i,state=getState(),expeditionID=_expeditionID||state.selectedExpedition,expedition=state.expeditions[expeditionID];expeditionDay||(date||(date=expedition.currentDate),expeditionDay=Math.floor((date.getTime()-expedition.start.getTime())/864e5));var daysToFetch=[];if(expedition.postsByDay[expeditionDay]){if("loading"===expedition.postsByDay[expeditionDay])return;for(i=expeditionDay-1;i>=0&&"loading"!==expedition.postsByDay[i];i--)if(!expedition.postsByDay[i]){daysToFetch.push(i),daysToFetch[0]=i;break}for(i=expeditionDay+1;i<expedition.dayCount&&"loading"!==expedition.postsByDay[i];i++)if(!expedition.postsByDay[i]){daysToFetch.push(i);break}}else daysToFetch.push(expeditionDay);if(0!==daysToFetch.length){var datesToFetch=[];daysToFetch.forEach(function(d,i){var t=expedition.start.getTime()+864e5*d;datesToFetch[i]=t});var range=[timestampToString(d3.min(datesToFetch)),timestampToString(d3.max(datesToFetch)+864e5)];dispatch({type:FETCH_POSTS_BY_DAY,expeditionID:expeditionID,daysToFetch:daysToFetch});var queryString="http://data.intotheokavango.org/api/features?limit=0&FeatureType=blog,audio,image,tweet&limit=0&Expedition="+state.selectedExpedition+"&startDate="+range[0]+"&endDate="+range[1];(0,_isomorphicFetch2.default)(queryString).then(function(response){return response.json()}).then(function(json){var results=json.results.features;return dispatch(receivePosts(expeditionID,results,range))}).then(function(){dispatch(checkFeedContent())})}}}function receivePosts(expeditionID,data,timeRange){return{type:RECEIVE_POSTS,expeditionID:expeditionID,data:data,timeRange:timeRange}}function completeDays(expeditionID){return{type:COMPLETE_DAYS,expeditionID:expeditionID}}function showLoadingWheel(){return{type:SHOW_LOADING_WHEEL}}function hideLoadingWheel(){return{type:HIDE_LOADING_WHEEL}}function jumpTo(date,expeditionID){return function(dispatch,getState){var state=getState(),expedition=state.expeditions[expeditionID],expeditionDay=Math.floor((date.getTime()-expedition.start.getTime())/864e5);return expedition.days[expeditionDay]?(dispatch(updateTime(date,!0,expeditionID)),dispatch(fetchDay(date))):(dispatch(showLoadingWheel()),dispatch(fetchDay(date)))}}function startAnimation(){return console.log("start animation"),{type:START}}function requestExpeditions(){return{type:REQUEST_EXPEDITIONS}}function updateTime(currentDate,updateMapState,expeditionID){return{type:UPDATE_TIME,currentDate:currentDate,updateMapState:updateMapState,expeditionID:expeditionID}}function updateMap(currentDate,coordinates,viewGeoBounds,zoom,expeditionID){return function(dispatch,getState){var state=getState(),expedition=state.expeditions[expeditionID],tiles=expedition.featuresByTile,tileResolution=Math.floor(111*(expedition.geoBounds[2]-expedition.geoBounds[0])/10),coordinatesToTile=function(coordinates,geoBounds){var x=Math.floor(111*(coordinates[0]-geoBounds[0])/10),y=Math.floor(111*(coordinates[1]-geoBounds[3])/10);return{x:x,y:y}},tileToCoordinates=function(tile,geoBounds){var lng=10*tile.x/111+geoBounds[0],lat=10*tile.y/111+geoBounds[3];return[lng,lat]},west=viewGeoBounds[0],north=viewGeoBounds[1],east=viewGeoBounds[2],south=viewGeoBounds[3],centroid=[(west+east)/2,(south+north)/2];west=centroid[0]+Math.max(west-centroid[0],-.1),east=centroid[0]+Math.min(east-centroid[0],.1),north=centroid[1]+Math.min(north-centroid[1],.1),south=centroid[1]+Math.max(south-centroid[1],-.1);for(var northWestTile=coordinatesToTile([west,north],expedition.geoBounds),southEastTile=Object.assign({},northWestTile);tileToCoordinates(southEastTile,expedition.geoBounds)[0]<=east;)southEastTile.x++;for(;tileToCoordinates(southEastTile,expedition.geoBounds)[1]>=south;)southEastTile.y--;for(var tileRange=[],tilesInView=[],x=northWestTile.x;x<=southEastTile.x;x++)for(var y=northWestTile.y;y>=southEastTile.y;y--){var tile=x+y*tileResolution;tiles[tile]||tileRange.push({x:x,y:y}),tilesInView.push(x+y*tileResolution)}var queryNorthWest=[180,-90],querySouthEast=[-180,90];tileRange.forEach(function(t){var northWest=tileToCoordinates(t,expedition.geoBounds),southEast=tileToCoordinates({x:t.x+1,y:t.y-1},expedition.geoBounds);queryNorthWest[0]>northWest[0]&&(queryNorthWest[0]=northWest[0]),queryNorthWest[1]<northWest[1]&&(queryNorthWest[1]=northWest[1]),querySouthEast[0]<southEast[0]&&(querySouthEast[0]=southEast[0]),querySouthEast[1]>southEast[1]&&(querySouthEast[1]=southEast[1])});var queryGeoBounds=[queryNorthWest[0],queryNorthWest[1],querySouthEast[0],querySouthEast[1]];if(tileRange.forEach(function(t,i,a){a[i]=t.x+t.y*tileResolution}),tileRange.length>0){var queryString="http://data.intotheokavango.org/api/features?limit=0&FeatureType=blog,audio,image,tweet,sighting&Expedition="+state.selectedExpedition+"&geoBounds="+queryGeoBounds.toString();(0,_isomorphicFetch2.default)(queryString).then(function(response){return response.json()}).then(function(json){var results=json.results.features;dispatch(receiveFeatures(state.selectedExpedition,results,tileRange))})}return dispatch({type:UPDATE_MAP,expeditionID:expeditionID,currentDate:currentDate,coordinates:coordinates,viewGeoBounds:viewGeoBounds,tilesInView:tilesInView,zoom:zoom,tileRange:tileRange})}}function receiveExpeditions(data){for(var k in data.results)data.results[k].Days<1&&delete data.results[k];return{type:RECEIVE_EXPEDITIONS,data:data}}function fetchExpeditions(){return function(dispatch,getState){return dispatch(requestExpeditions()),(0,_isomorphicFetch2.default)("http://data.intotheokavango.org/api/expeditions").then(function(response){return response.json()}).then(function(json){return dispatch(receiveExpeditions(json))}).then(function(){return dispatch(fetchDay((0,_utils.parseDate)("2017-08-06T07:55:39+0200"),null,null,!0))}).then(function(){var state=getState();dispatch(fetchTotalSightings(state.selectedExpedition)),"/journal"===location.pathname&&dispatch(checkFeedContent())})}}function fetchTotalSightings(id){return function(dispatch,getState){return(0,_isomorphicFetch2.default)("http://data.intotheokavango.org/api/features?FeatureType=sighting&limit=0&Expedition="+id).then(function(response){return response.json()}).then(function(json){return dispatch(receiveTotalSightings(id,json))})}}function receiveTotalSightings(id,data){return{type:RECEIVE_TOTAL_SIGHTINGS,id:id,data:data}}function fetchDay(date,initialDate,_expeditionID,initialize){return initialDate||(initialDate=date),function(dispatch,getState){var state=getState(),expeditionID=_expeditionID||state.selectedExpedition,expedition=state.expeditions[expeditionID];date||(date=expedition.currentDate);var expeditionDay=Math.floor((date.getTime()-expedition.start.getTime())/864e5),daysToFetch=[];if(!expedition.days[expeditionDay-1]&&expeditionDay-1>=0&&daysToFetch.push(expeditionDay-1),expedition.days[expeditionDay]||daysToFetch.push(expeditionDay),!expedition.days[expeditionDay+1]&&expeditionDay+1<expedition.dayCount&&daysToFetch.push(expeditionDay+1),0!==daysToFetch.length){daysToFetch.forEach(function(d,i,a){var t=expedition.start.getTime()+864e5*d;a[i]=t});var range=[timestampToString(d3.min(daysToFetch)),timestampToString(d3.max(daysToFetch)+864e5)],goFetch=function goFetch(featureTypes,results,expeditionID){var type=featureTypes.shift(),queryString="http://data.intotheokavango.org/api/features?limit=0&FeatureType="+type+"&Expedition="+expeditionID+"&startDate="+range[0]+"&endDate="+range[1];"ambit_geo"===type&&(queryString+="&resolution=2"),(0,_isomorphicFetch2.default)(queryString).then(function(response){return response.json()}).then(function(json){if(results=results.concat(json.results.features),featureTypes.length>0)goFetch(featureTypes,results,expeditionID);else{dispatch(receiveDay(expeditionID,results,range)),dispatch(completeDays(expeditionID));var state=getState(),expedition=state.expeditions[state.selectedExpedition],days=expedition.days,incompleteDays=[];if(d3.keys(expedition.days).forEach(function(k){expedition.days[k].incomplete&&incompleteDays.push(k)}),0===incompleteDays.length)!state.animate&&initialize&&(console.log("STARTING HERE"),dispatch(startAnimation()),dispatch(updateTime(initialDate||date,!1,expeditionID)),dispatch(hideLoadingWheel()));else{for(var nextTarget=-1,i=0;i<incompleteDays.length;i++){for(var id=incompleteDays[i],j=Math.max(0,id-1);j<expedition.dayCount;j++)if(!days[j]){nextTarget=j;break}if(nextTarget>-1)break}nextTarget>-1&&(nextTarget=new Date(expedition.start.getTime()+864e5*nextTarget),dispatch(fetchDay(nextTarget,null,expeditionID,initialize)))}}})};goFetch(["ambit_geo","beacon"],[],expeditionID)}}}function setExpedition(id){return function(dispatch,getState){var state=getState(),expedition=state.expeditions[id];0===expedition.totalSightings.length&&dispatch(fetchTotalSightings(id)),dispatch({type:SET_EXPEDITION,id:id})}}function setControl(target,mode){return{type:SET_CONTROL,target:target,mode:mode}}function requestDay(expeditionID,dayID){return{type:REQUEST_DAY,expeditionID:expeditionID,dayID:dayID}}function receiveDay(expeditionID,data,dateRange){return{type:RECEIVE_DAY,expeditionID:expeditionID,data:data,dateRange:dateRange}}function receiveFeatures(expeditionID,data,tileRange){return{type:RECEIVE_FEATURES,expeditionID:expeditionID,data:data,tileRange:tileRange}}function selectFeature(){return{type:SELECT_FEATURE}}function unselectFeature(){return{type:UNSELECT_FEATURE}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.UNSELECT_FEATURE=exports.SELECT_FEATURE=exports.RECEIVE_FEATURES=exports.RECEIVE_DAY=exports.REQUEST_DAY=exports.SET_CONTROL=exports.SET_EXPEDITION=exports.RECEIVE_TOTAL_SIGHTINGS=exports.RECEIVE_EXPEDITIONS=exports.UPDATE_MAP=exports.UPDATE_TIME=exports.REQUEST_EXPEDITIONS=exports.START=exports.JUMP_TO=exports.HIDE_LOADING_WHEEL=exports.SHOW_LOADING_WHEEL=exports.COMPLETE_DAYS=exports.RECEIVE_POSTS=exports.FETCH_POSTS_BY_DAY=exports.SET_PAGE=exports.ENABLE_CONTENT=exports.SHOW_360_PICTURE=exports.CLOSE_LIGHTBOX=void 0,exports.closeLightBox=closeLightBox,exports.show360Picture=show360Picture,exports.enableContent=enableContent,exports.setPage=setPage,exports.checkFeedContent=checkFeedContent,exports.fetchPostsByDay=fetchPostsByDay,exports.receivePosts=receivePosts,exports.completeDays=completeDays,exports.showLoadingWheel=showLoadingWheel,exports.hideLoadingWheel=hideLoadingWheel,exports.jumpTo=jumpTo,exports.startAnimation=startAnimation,exports.requestExpeditions=requestExpeditions,exports.updateTime=updateTime,exports.updateMap=updateMap,exports.receiveExpeditions=receiveExpeditions,exports.fetchExpeditions=fetchExpeditions,exports.fetchTotalSightings=fetchTotalSightings,exports.receiveTotalSightings=receiveTotalSightings,exports.fetchDay=fetchDay,exports.setExpedition=setExpedition,exports.setControl=setControl,exports.requestDay=requestDay,exports.receiveDay=receiveDay,exports.receiveFeatures=receiveFeatures,exports.selectFeature=selectFeature,exports.unselectFeature=unselectFeature;var _isomorphicFetch=__webpack_require__(830),_isomorphicFetch2=_interopRequireDefault(_isomorphicFetch),_d=__webpack_require__(87),d3=_interopRequireWildcard(_d),_utils=__webpack_require__(67),CLOSE_LIGHTBOX=exports.CLOSE_LIGHTBOX="CLOSE_LIGHTBOX",SHOW_360_PICTURE=exports.SHOW_360_PICTURE="SHOW_360_PICTURE",ENABLE_CONTENT=exports.ENABLE_CONTENT="ENABLE_CONTENT",SET_PAGE=exports.SET_PAGE="SET_PATH",FETCH_POSTS_BY_DAY=exports.FETCH_POSTS_BY_DAY="FETCH_POSTS_BY_DAY",RECEIVE_POSTS=exports.RECEIVE_POSTS="RECEIVE_POSTS",COMPLETE_DAYS=exports.COMPLETE_DAYS="COMPLETE_DAYS",SHOW_LOADING_WHEEL=exports.SHOW_LOADING_WHEEL="SHOW_LOADING_WHEEL",HIDE_LOADING_WHEEL=exports.HIDE_LOADING_WHEEL="HIDE_LOADING_WHEEL",START=(exports.JUMP_TO="JUMP_TO",exports.START="START"),REQUEST_EXPEDITIONS=exports.REQUEST_EXPEDITIONS="REQUEST_EXPEDITIONS",UPDATE_TIME=exports.UPDATE_TIME="UPDATE_TIME",UPDATE_MAP=exports.UPDATE_MAP="UPDATE_MAP",RECEIVE_EXPEDITIONS=exports.RECEIVE_EXPEDITIONS="RECEIVE_EXPEDITIONS",RECEIVE_TOTAL_SIGHTINGS=exports.RECEIVE_TOTAL_SIGHTINGS="RECEIVE_TOTAL_SIGHTINGS",SET_EXPEDITION=exports.SET_EXPEDITION="SET_EXPEDITION",SET_CONTROL=exports.SET_CONTROL="SET_CONTROL",REQUEST_DAY=exports.REQUEST_DAY="REQUEST_DAY",RECEIVE_DAY=exports.RECEIVE_DAY="RECEIVE_DAY",RECEIVE_FEATURES=exports.RECEIVE_FEATURES="RECEIVE_FEATURES",SELECT_FEATURE=exports.SELECT_FEATURE="SELECT_FEATURE",UNSELECT_FEATURE=exports.UNSELECT_FEATURE="UNSELECT_FEATURE"},271:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};return Object.keys(descriptor).forEach(function(key){desc[key]=descriptor[key]}),desc.enumerable=!!desc.enumerable,desc.configurable=!!desc.configurable,("value"in desc||desc.initializer)&&(desc.writable=!0),desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc},desc),context&&void 0!==desc.initializer&&(desc.value=desc.initializer?desc.initializer.call(context):void 0,desc.initializer=void 0),void 0===desc.initializer&&(Object.defineProperty(target,property,desc),desc=null),desc}Object.defineProperty(exports,"__esModule",{value:!0});var _class,_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_utils=__webpack_require__(67),_three=__webpack_require__(2),THREE=_interopRequireWildcard(_three),_reactThreeRenderer=__webpack_require__(406),_reactThreeRenderer2=_interopRequireDefault(_reactThreeRenderer),_autobindDecorator=__webpack_require__(66),_autobindDecorator2=_interopRequireDefault(_autobindDecorator),Post=(_class=function(_React$Component){function Post(props){_classCallCheck(this,Post);var _this=_possibleConstructorReturn(this,(Post.__proto__||Object.getPrototypeOf(Post)).call(this,props));return _this.state={sphereScale:new THREE.Vector3(-1,1,1),width:640,height:360,isUserInteracting:!1,onMouseDownMouseX:0,onMouseDownMouseY:0,lon:0,onMouseDownLon:0,lat:0,onMouseDownLat:0,phi:0,theta:0,cameraTarget:new THREE.Vector3(1,0,0),fov:75,closeMouseOver:!1},_this}return _inherits(Post,_React$Component),_createClass(Post,[{key:"componentWillReceiveProps",value:function(nextProps){var data=this.props.data;if("360Image"===data.type){var width=.85*document.querySelector("div.post"+data.key).clientWidth,height=window.innerHeight-250;this.setState(_extends({},this.state,{width:width,height:height}))}}},{key:"onMouseDown",value:function(event){var _state=this.state,lon=_state.lon,lat=_state.lat,clientX=event.clientX,clientY=event.clientY;this.setState(_extends({},this.state,{isUserInteracting:!0,onMouseDownMouseX:clientX,onMouseDownMouseY:clientY,onMouseDownLon:lon,onMouseDownLat:lat})),event.stopPropagation()}},{key:"onMouseMove",value:function(event){var _state2=this.state,isUserInteracting=_state2.isUserInteracting,onMouseDownMouseX=_state2.onMouseDownMouseX,onMouseDownLon=_state2.onMouseDownLon,onMouseDownMouseY=_state2.onMouseDownMouseY,onMouseDownLat=_state2.onMouseDownLat;if(isUserInteracting===!0){var lon=.1*(onMouseDownMouseX-event.clientX)+onMouseDownLon,lat=Math.max(-85,Math.min(85,.1*(event.clientY-onMouseDownMouseY)+onMouseDownLat)),phi=THREE.Math.degToRad(90-lat),theta=THREE.Math.degToRad(lon),cameraTarget=new THREE.Vector3(500*Math.sin(phi)*Math.cos(theta),500*Math.cos(phi),500*Math.sin(phi)*Math.sin(theta));this.setState(_extends({},this.state,{lon:lon,lat:lat,cameraTarget:cameraTarget}))}}},{key:"onMouseUp",value:function(event){this.setState(_extends({},this.state,{isUserInteracting:!1})),event.stopPropagation()}},{key:"onClick",value:function(event){event.stopPropagation()}},{key:"onMouseOut",value:function(event){this.setState(_extends({},this.state,{isUserInteracting:!1})),event.stopPropagation()}},{key:"onMouseWheel",value:function(event){}},{key:"render",value:function(){var _this2=this,_props=this.props,format=_props.format,data=_props.data,closeLightBox=_props.closeLightBox,show360Picture=_props.show360Picture,_state3=this.state,width=_state3.width,height=_state3.height,sphereScale=_state3.sphereScale,fov=_state3.fov;if("full"===format){var metaTypes=["date"];data.location&&metaTypes.push("location"),data.link&&metaTypes.push("link");var meta=metaTypes.map(function(m,i){var value=function(){if("date"===m){var d=new Date(data.date);return _react2.default.createElement("p",null,(0,_utils.dateToString)(d,!0))}if("full"===format)return _react2.default.createElement("img",{width:"16",height:"16",key:i,src:"/static/img/icon-"+m+".png"})}();return _react2.default.createElement("div",{className:m,key:i},value)}),content=function(data){switch(data.type){case"tweet":var images=data.images?data.images.map(function(url,i){return _react2.default.createElement("img",{src:url,key:i})}):"";return _react2.default.createElement("div",null,_react2.default.createElement("p",{className:"message"},'"',data.content,'"'),images);case"image":return _react2.default.createElement("div",null,_react2.default.createElement("img",{src:data.images[0]}),_react2.default.createElement("p",null,data.content));case"360Image":return _react2.default.createElement("div",{onMouseDown:_this2.onMouseDown,onMouseMove:_this2.onMouseMove,onMouseUp:_this2.onMouseUp,onMouseOut:_this2.onMouseOut,onWheel:_this2.onMouseWheel,onClick:_this2.onClick},_react2.default.createElement("div",{className:"interaction-helper"},_react2.default.createElement("div",null,_react2.default.createElement("img",{src:"/static/img/icon-360.svg"}),"Drag image to rotate view")),_react2.default.createElement(_reactThreeRenderer2.default,{mainCamera:"lightbox-camera",width:width,height:height},_react2.default.createElement("scene",null,_react2.default.createElement("perspectiveCamera",{name:"lightbox-camera",fov:fov,aspect:width/height,near:1,far:1100,position:new THREE.Vector3(0,0,0),lookAt:_this2.state.cameraTarget}),_react2.default.createElement("mesh",{scale:sphereScale},_react2.default.createElement("sphereGeometry",{radius:500,widthSegments:60,heightSegments:40}),_react2.default.createElement("meshBasicMaterial",null,_react2.default.createElement("texture",{url:data.images[0]}))))));case"audio":var soundCloudURL="https://w.soundcloud.com/player/?url=";return soundCloudURL+=data.link,soundCloudURL+="&color=F8D143&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false",_react2.default.createElement("div",null,_react2.default.createElement("h2",null,data.title),_react2.default.createElement("p",null,"sound"),_react2.default.createElement("iframe",{src:soundCloudURL}));case"blog":return _react2.default.createElement("div",null,_react2.default.createElement("h2",null,data.title),_react2.default.createElement("p",null,data.content),_react2.default.createElement("p",null,_react2.default.createElement("a",{href:data.link},"Read more...")));default:return""}};return _react2.default.createElement("div",{className:"post post"+data.key},_react2.default.createElement("div",{className:"type"},_react2.default.createElement("img",{width:"16",height:"16",src:"/static/img/icon-"+data.type+".png"})),_react2.default.createElement("div",{className:"content"},content(data),"360Image"!==data.type&&_react2.default.createElement("div",{className:"meta"},meta,_react2.default.createElement("div",{className:"share"},_react2.default.createElement("img",{width:"16",height:"16",src:"static/img/icon-share.png"})),_react2.default.createElement("div",{className:"separator"}))),"360Image"===data.type&&_react2.default.createElement("div",{className:"actions"},_react2.default.createElement("div",{className:"button close",onMouseOver:function(){_this2.setState(_extends({},_this2.state,{closeMouseOver:!0}))},onMouseOut:function(){_this2.setState(_extends({},_this2.state,{closeMouseOver:!1}))},onClick:closeLightBox},_react2.default.createElement("img",{width:"16",height:"16",src:"/static/img/icon-close"+(this.state.closeMouseOver?"-hover":"")+".png"})),_react2.default.createElement("div",{className:"button forward",onMouseOver:function(){_this2.setState(_extends({},_this2.state,{forwardMouseOver:!0}))},onMouseOut:function(){_this2.setState(_extends({},_this2.state,{forwardMouseOver:!1}))},onMouseDown:function(event){data.next&&show360Picture(data.next),event.stopPropagation()}},_react2.default.createElement("img",{width:"16",height:"16",src:"/static/img/icon-forward"+(this.state.forwardMouseOver?"-hover":"")+".png"})),_react2.default.createElement("div",{className:"button backward",onMouseOver:function(){_this2.setState(_extends({},_this2.state,{backwardMouseOver:!0}))},onMouseOut:function(){_this2.setState(_extends({},_this2.state,{backwardMouseOver:!1}))},onMouseDown:function(event){data.previous&&show360Picture(data.previous),event.stopPropagation()}},_react2.default.createElement("img",{width:"16",height:"16",src:"/static/img/icon-backward"+(this.state.backwardMouseOver?"-hover":"")+".png"}))))}return""}}]),Post}(_react2.default.Component),_applyDecoratedDescriptor(_class.prototype,"onMouseDown",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseDown"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"onMouseMove",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseMove"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"onMouseUp",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseUp"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"onClick",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onClick"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"onMouseOut",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseOut"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"onMouseWheel",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseWheel"),_class.prototype),_class);Post.propTypes={format:_react.PropTypes.string.isRequired,data:_react.PropTypes.object.isRequired,closeLightBox:_react.PropTypes.func,show360Picture:_react.PropTypes.func},exports.default=Post},272:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _reactRedux=__webpack_require__(131),_ControlPanel=__webpack_require__(445),_ControlPanel2=_interopRequireDefault(_ControlPanel),_actions=__webpack_require__(116),actions=_interopRequireWildcard(_actions),mapStateToProps=function(state,ownProps){var props={currentPage:state.currentPage,expeditionID:state.selectedExpedition,expeditions:state.expeditions},expedition=state.expeditions[state.selectedExpedition];return props.expeditionID&&(props.currentDate=expedition.currentDate,props.playback=expedition.playback,props.mainFocus=expedition.mainFocus,props.secondaryFocus=expedition.secondaryFocus,props.zoom=expedition.zoom,props.layout=expedition.layout,props.viewport={width:window.innerWidth,height:window.innerHeight,longitude:expedition.coordinates[0],latitude:expedition.coordinates[1],zoom:expedition.zoom}),props},mapDispatchToProps=function(dispatch,ownProps){return{onYearChange:function(value){return dispatch(actions.setExpedition(value))},onPlaybackChange:function(value){return dispatch(actions.setControl("playback",value))},onMainFocusChange:function(value){return dispatch(actions.setControl("mainFocus",value))},onSecondaryFocusChange:function(value){return dispatch(actions.setControl("secondaryFocus",value))},onZoomChange:function(value){return dispatch(actions.setControl("zoom",value))},onLayoutChange:function(value){return dispatch(actions.setControl("layout",value))}}},ControlPanelContainer=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(_ControlPanel2.default);exports.default=ControlPanelContainer},442:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),APIExplorer=function(){return _react2.default.createElement("p",null,"Coming soon...")};exports.default=APIExplorer},443:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),AboutPage=function(){return _react2.default.createElement("div",{className:"page",id:"aboutPage"},_react2.default.createElement("div",{className:"pageWrapper"},_react2.default.createElement("div",{className:"cta"},_react2.default.createElement("a",{href:"https://www.nationalgeographic.org/projects/okavango/"},_react2.default.createElement("p",null,"The National Geographic Okavango Wilderness Project",_react2.default.createElement("img",{src:"static/img/external-link.svg",width:"25px"})))),_react2.default.createElement("div",{className:"content"},_react2.default.createElement("h1",null,"What We’re Doing"),_react2.default.createElement("p",null,"The Okavango Delta is one of the most important sites for biodiversity, hosting the largest population of African elephants in addition to lions, cheetahs, wild dogs and hundreds of species of birds. Yet the future of this oasis is directly linked to its source - over 800 miles to the north in the central highlands of Angola. This water tower, which flows through Angola, Namibia and Botswana, is the main source of water for over a million people, providing the lifeline for the region. While the Delta itself has been declared a World Heritage Site, the rivers and wilderness areas it depends on remain unprotected."),_react2.default.createElement("img",{src:"static/img/about-cuito.jpg",
className:"photo",width:"100%"}),_react2.default.createElement("p",null,"Beginning in 2015, National Geographic Fellow, Dr. Steve Boyes, assembled a team of regional and international scientists to embark on a multi-year journey to explore and protect the headwaters and rivers in Angola. Covering thousands of miles on foot, bike, and mokoro, or traditional canoe, the team is discovering an area that has long been hidden behind a curtain of landmines – a legacy of past conflict. Their findings, which include potential new species to science and to Angola, countless species range extensions, and an intricate ecosystem that regulates the ebb and flow of the entire basin system, highlight the need to protect this area before it is too late."),_react2.default.createElement("img",{src:"static/img/about-elephants.jpg",className:"photo",width:"100%"})),_react2.default.createElement("div",{className:"cta"},_react2.default.createElement("a",{href:"https://www.nationalgeographic.org/projects/okavango/"},_react2.default.createElement("p",null,"The National Geographic Okavango Wilderness Project",_react2.default.createElement("img",{src:"static/img/external-link.svg",width:"25px"}))))))};AboutPage.propTypes={},exports.default=AboutPage},444:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};return Object.keys(descriptor).forEach(function(key){desc[key]=descriptor[key]}),desc.enumerable=!!desc.enumerable,desc.configurable=!!desc.configurable,("value"in desc||desc.initializer)&&(desc.writable=!0),desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc},desc),context&&void 0!==desc.initializer&&(desc.value=desc.initializer?desc.initializer.call(context):void 0,desc.initializer=void 0),void 0===desc.initializer&&(Object.defineProperty(target,property,desc),desc=null),desc}Object.defineProperty(exports,"__esModule",{value:!0});var _class,_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_autobindDecorator=__webpack_require__(66),_autobindDecorator2=_interopRequireDefault(_autobindDecorator),_d=__webpack_require__(87),d3=_interopRequireWildcard(_d),_viewportMercatorProject=__webpack_require__(270),_viewportMercatorProject2=_interopRequireDefault(_viewportMercatorProject),_utils=__webpack_require__(67),_WebGLOverlay=__webpack_require__(465),_WebGLOverlay2=_interopRequireDefault(_WebGLOverlay),_reactMapGl=__webpack_require__(921),_reactMapGl2=_interopRequireDefault(_reactMapGl),_three=__webpack_require__(2),THREE=_interopRequireWildcard(_three),BackgroundMap=(_class=function(_React$Component){function BackgroundMap(props){_classCallCheck(this,BackgroundMap);var _this=_possibleConstructorReturn(this,(BackgroundMap.__proto__||Object.getPrototypeOf(BackgroundMap)).call(this,props));return _this.simpleState={frameCount:0,contentActive:!1,animate:!1,sortedBeacons:null,sortedAmbits:{},coordinates:[0,0],viewport:{latitude:-12.7373785,longitude:15.8180427,zoom:4,width:window.innerWidth,height:window.innerHeight,startDragLngLat:null,isDragging:!1}},_this.prevState=_extends({},_this.simpleState),_this}return _inherits(BackgroundMap,_React$Component),_createClass(BackgroundMap,[{key:"tick",value:function(pastFrameDate){var _this2=this,newState={},speedFactor=(Date.now()-pastFrameDate)/(1e3/60),currentFrameDate=Date.now();if(currentFrameDate-pastFrameDate<33)return void requestAnimationFrame(function(){_this2.tick(pastFrameDate)});var _props=this.props,expeditionID=_props.expeditionID,animate=_props.animate,expedition=_props.expedition,fetchDay=_props.fetchDay,setControl=_props.setControl,isFetching=_props.isFetching,updateMap=_props.updateMap,b1=void 0,b2=void 0;if(animate&&!isFetching&&("/map"===location.pathname||"/"===location.pathname)){var dateOffset=0,forward="fastForward"===expedition.playback||"forward"===expedition.playback||"pause"===expedition.playback;if(this.simpleState.beaconIndex===(forward?0:1)||this.simpleState.beaconIndex===(forward?d3.values(this.simpleState.day.beacons).length-2:d3.values(this.simpleState.day.beacons).length-1)){var offset=this.simpleState.timeToNextBeacon>0?Math.min(1e5,this.simpleState.timeToNextBeacon+1):1e5;"fastBackward"!==expedition.playback&&"backward"!==expedition.playback||(dateOffset=-1*offset),"forward"!==expedition.playback&&"fastForward"!==expedition.playback||(dateOffset=offset)}else"fastBackward"===expedition.playback&&(dateOffset=-25e3),"backward"===expedition.playback&&(dateOffset=-4e3),"forward"===expedition.playback&&(dateOffset=4e3),"fastForward"===expedition.playback&&(dateOffset=25e3);var currentDate=new Date(Math.min(expedition.end.getTime()-1,Math.max(expedition.start.getTime()+1,this.simpleState.currentDate.getTime()+dateOffset)));(currentDate.getTime()!==expedition.end.getTime()-1||"forward"!==expedition.playback&&"fastForward"!==expedition.playback)&&(currentDate.getTime()!==expedition.start.getTime()+1||"backward"!==expedition.playback&&"fastBackward"!==expedition.playback)||setControl("playback","pause");var currentDay=Math.floor((currentDate.getTime()-expedition.start.getTime())/864e5);currentDay!==this.simpleState.currentDay&&(this.simpleState.sortedBeacons=null,this.simpleState.sortedAmbits={},fetchDay(currentDate));var day=expedition.days[currentDay];this.simpleState.sortedBeacons||(this.simpleState.sortedBeacons=d3.values(day.beacons).sort(function(a,b){return(0,_utils.parseDate)(a.properties.DateTime).getTime()-(0,_utils.parseDate)(b.properties.DateTime).getTime()}));var beacons=this.simpleState.sortedBeacons,beaconCount=beacons.length,beaconIndex=void 0,timeToNextBeacon=0,ratioBetweenBeacons=0;if("forward"===expedition.playback||"fastForward"===expedition.playback||"pause"===expedition.playback){for(var i=0;i<beaconCount-1;i++)if(b1=(0,_utils.parseDate)(beacons[i].properties.DateTime).getTime(),b2=(0,_utils.parseDate)(beacons[i+1].properties.DateTime).getTime(),currentDate.getTime()>=b1&&currentDate.getTime()<b2){beaconIndex=i,timeToNextBeacon=b2-currentDate.getTime(),ratioBetweenBeacons=(currentDate.getTime()-b1)/(b2-b1);break}beaconIndex<0&&(beaconIndex=beaconCount-1)}else{for(var _i2=beaconCount-1;_i2>0;_i2--)if(b1=(0,_utils.parseDate)(beacons[_i2].properties.DateTime).getTime(),b2=(0,_utils.parseDate)(beacons[_i2-1].properties.DateTime).getTime(),currentDate.getTime()<=b1&&currentDate.getTime()>b2){beaconIndex=_i2,timeToNextBeacon=currentDate.getTime()-b2,ratioBetweenBeacons=(currentDate.getTime()-b1)/(b2-b1);break}beaconIndex<0&&(beaconIndex=0)}var currentBeacon=beacons[beaconIndex+0],nextBeacon=beacons[beaconIndex+(forward?1:-1)];if(!currentBeacon||!nextBeacon)return this.simpleState.sortedBeacons=null,this.simpleState.sortedAmbits={},void requestAnimationFrame(function(){_this2.tick(currentFrameDate)});var coordinates=[(0,_utils.lerp)(currentBeacon.geometry.coordinates[0],nextBeacon.geometry.coordinates[0],ratioBetweenBeacons),(0,_utils.lerp)(currentBeacon.geometry.coordinates[1],nextBeacon.geometry.coordinates[1],ratioBetweenBeacons)],members=_extends({},expedition.members);Object.keys(members).forEach(function(memberID){var member=members[memberID];_this2.simpleState.sortedAmbits[memberID]||(_this2.simpleState.sortedAmbits[memberID]={}),_this2.simpleState.sortedAmbits[memberID][currentDay]||(_this2.simpleState.sortedAmbits[memberID][currentDay]=d3.values(expedition.featuresByMember[memberID][currentDay]).sort(function(a,b){return(0,_utils.parseDate)(a.properties.DateTime).getTime()-(0,_utils.parseDate)(b.properties.DateTime).getTime()}));var ambits=_this2.simpleState.sortedAmbits[memberID][currentDay],ambitCount=ambits.length,ambitIndex=-1,ratioBetweenAmbits=0;if("forward"===expedition.playback||"fastForward"===expedition.playback||"pause"===expedition.playback){for(var _i3=0;_i3<ambitCount-1;_i3++)if(b1=(0,_utils.parseDate)(ambits[_i3].properties.DateTime).getTime(),b2=(0,_utils.parseDate)(ambits[_i3+1].properties.DateTime).getTime(),currentDate.getTime()>=b1&&currentDate.getTime()<b2){ambitIndex=_i3,ratioBetweenAmbits=(currentDate.getTime()-b1)/(b2-b1);break}ambitIndex<0&&(ambitIndex=ambitCount-2,ratioBetweenAmbits=1)}else{for(var _i4=ambitCount-1;_i4>0;_i4--)if(b1=(0,_utils.parseDate)(ambits[_i4].properties.DateTime).getTime(),b2=(0,_utils.parseDate)(ambits[_i4-1].properties.DateTime).getTime(),currentDate.getTime()<=b1&&currentDate.getTime()>b2){ambitIndex=_i4,ratioBetweenAmbits=(currentDate.getTime()-b1)/(b2-b1);break}ambitIndex<0&&(ambitIndex=1,ratioBetweenAmbits=1)}var currentID=ambitIndex,nextID=ambitIndex+(forward?1:-1);if(currentID>=0&&currentID<ambits.length&&nextID>=0&&nextID<ambits.length){var currentAmbits=ambits[currentID],nextAmbit=ambits[nextID];if(!currentAmbits||!nextAmbit)return _this2.simpleState.sortedBeacons=null,_this2.simpleState.sortedAmbits={},void requestAnimationFrame(function(){_this2.tick(currentFrameDate)});member.coordinates=[(0,_utils.lerp)(currentAmbits.geometry.coordinates[0],nextAmbit.geometry.coordinates[0],ratioBetweenAmbits),(0,_utils.lerp)(currentAmbits.geometry.coordinates[1],nextAmbit.geometry.coordinates[1],ratioBetweenAmbits)]}else member.coordinates=[-180,90]});var zoom=(0,_utils.lerp)(this.simpleState.viewport.zoom,this.simpleState.viewport.targetZoom,Math.pow(this.simpleState.viewport.zoom/this.simpleState.viewport.targetZoom,2)/250*speedFactor);if(newState=_extends({},newState,{currentDate:currentDate,animate:animate,currentDay:currentDay,day:day,beaconIndex:beaconIndex,timeToNextBeacon:timeToNextBeacon,members:members,contentActive:this.props.contentActive,viewport:_extends({},this.simpleState.viewport,{longitude:coordinates[0],latitude:coordinates[1],zoom:zoom})}),this.simpleState.frameCount%60===0){var _ViewportMercator=(0,_viewportMercatorProject2.default)(_extends({},this.simpleState.viewport)),unproject=_ViewportMercator.unproject,nw=unproject([0,0]),se=unproject([window.innerWidth,window.innerHeight]),viewGeoBounds=[nw[0],nw[1],se[0],se[1]];updateMap(this.simpleState.currentDate,[this.simpleState.viewport.longitude,this.simpleState.viewport.latitude],viewGeoBounds,this.simpleState.viewport.zoom,expeditionID)}}this.prevState=this.simpleState,this.simpleState=_extends({},this.simpleState,newState,{animate:animate,frameCount:this.simpleState.frameCount+1}),this.simpleState.frameCount%60!==0&&this.forceUpdate(),requestAnimationFrame(function(){_this2.tick(currentFrameDate)})}},{key:"shouldComponentUpdate",value:function(_1,_2){return!(!this.props.expedition||"pause"===this.props.expedition.playback||this.simpleState.frameCount===this.prevState.frameCount)}},{key:"componentWillReceiveProps",value:function(nextProps){var animate=nextProps.animate,expedition=nextProps.expedition,mapStateNeedsUpdate=nextProps.mapStateNeedsUpdate;if(animate){var currentDate=expedition.currentDate,currentDay=Math.floor((currentDate.getTime()-expedition.start.getTime())/864e5),day=expedition.days[currentDay];mapStateNeedsUpdate&&(this.simpleState.currentDate=currentDate,this.simpleState.currentDay=currentDay,this.simpleState.day=day,this.simpleState.frameCount=0),this.simpleState.animate||(this.simpleState.animate=animate,this.simpleState.viewport=_extends({},this.simpleState.viewport,{zoom:expedition.initialZoom,targetZoom:expedition.targetZoom}),this.tick(Math.round(Date.now()-1e3/60)))}}},{key:"redrawGLOverlay",value:function(_ref){var _this3=this,unproject=_ref.unproject,screenBounds=[[0,0],[window.innerWidth,window.innerHeight]].map(unproject);return function(particles,paths){var expedition=_this3.props.expedition,currentGeoBounds=expedition.currentGeoBounds,west=currentGeoBounds[0]+.25*(currentGeoBounds[0]-currentGeoBounds[2]),north=currentGeoBounds[1]+.25*(currentGeoBounds[1]-currentGeoBounds[3]),east=currentGeoBounds[2]+.25*(currentGeoBounds[2]-currentGeoBounds[0]),south=currentGeoBounds[3]+.25*(currentGeoBounds[3]-currentGeoBounds[1]),gb=[west,north,east,south];return expedition.zoom<10?{particles:particles,paths:paths}:{particles:_extends({},particles,{sightings:_this3.renderSightings(particles.sightings,screenBounds,expedition,gb),members:_this3.renderMembers(particles.members,screenBounds,expedition,gb)}),paths:{ambitGeo:_this3.renderAmbitGeo(paths.ambitGeo,screenBounds,expedition,gb)}}}}},{key:"mapToScreen",value:function(p,screenBounds){var offset=0;return[offset+(window.innerWidth-offset)*((p[0]-screenBounds[0][0])/(screenBounds[1][0]-screenBounds[0][0])),offset+(window.innerHeight-offset)*((p[1]-screenBounds[0][1])/(screenBounds[1][1]-screenBounds[0][1]))]}},{key:"renderAmbitGeo",value:function(pathGeometry,screenBounds,expedition,gb){var _this4=this,checkGeoBounds=function(p,gb){return p[0]>=gb[0]&&p[0]<gb[2]&&p[1]>=gb[3]&&p[1]<gb[1]};return expedition.currentAmbits.map(function(route){var vertices=route.coordinates.filter(function(p,i){return!(!route.coordinates[i-1]||!checkGeoBounds(route.coordinates[i-1],gb))||(!!checkGeoBounds(route.coordinates[i],gb)||route.coordinates[i+1]&&checkGeoBounds(route.coordinates[i+1],gb))}).map(function(p){return _this4.mapToScreen(p,screenBounds)}).map(function(p,_i){return new THREE.Vector3(p[0],p[1],0)});if(vertices.length>0){var lastVertex=vertices[vertices.length-1].clone();if(lastVertex)for(var i=vertices.length;i<1e3;i++)vertices[i]=lastVertex}return{color:route.color,vertices:vertices}})}},{key:"render360Images",value:function(particleGeometry,screenBounds,expedition,gb){for(var images=expedition.current360Images.filter(function(image){var coords=image.geometry.coordinates;return coords[0]>=gb[0]&&coords[0]<gb[2]&&coords[1]>=gb[3]&&coords[1]<gb[1]}),i=0;i<particleGeometry.count;i++){var image=images[i];if(image){var coords=this.mapToScreen([image.geometry.coordinates[0],image.geometry.coordinates[1]],screenBounds);particleGeometry.position.array[3*i+0]=coords[0],particleGeometry.position.array[3*i+1]=coords[1],particleGeometry.position.array[3*i+2]=0,particleGeometry.color.array[4*i+0]=.62,particleGeometry.color.array[4*i+1]=.6,particleGeometry.color.array[4*i+2]=.7,particleGeometry.color.array[4*i+3]=1}else particleGeometry.position.array[3*i+0]=0,particleGeometry.position.array[3*i+1]=0,particleGeometry.position.array[3*i+2]=0,particleGeometry.color.array[4*i+0]=0,particleGeometry.color.array[4*i+1]=0,particleGeometry.color.array[4*i+2]=0,particleGeometry.color.array[4*i+3]=0}return particleGeometry.position.needsUpdate=!0,particleGeometry.color.needsUpdate=!0,particleGeometry.data=images,particleGeometry}},{key:"renderSightings",value:function(particleGeometry,screenBounds,expedition,gb){for(var sightings=expedition.currentSightings.filter(function(sighting,_i){var position=sighting.position;return position.x>=gb[0]&&position.x<gb[2]&&position.y>=gb[3]&&position.y<gb[1]}),i=0;i<particleGeometry.count;i++){var sighting=sightings[i];if(sighting){var position=sighting.position,radius=sighting.radius,coords=this.mapToScreen([position.x,position.y],screenBounds),color=new THREE.Color(sighting.color);particleGeometry.position.array[3*i+0]=coords[0],particleGeometry.position.array[3*i+1]=coords[1],particleGeometry.position.array[3*i+2]=2*radius,particleGeometry.color.array[4*i+0]=color.r,particleGeometry.color.array[4*i+1]=color.g,particleGeometry.color.array[4*i+2]=color.b,particleGeometry.color.array[4*i+3]=1}else particleGeometry.position.array[3*i+0]=0,particleGeometry.position.array[3*i+1]=0,particleGeometry.position.array[3*i+2]=0,particleGeometry.color.array[4*i+0]=0,particleGeometry.color.array[4*i+1]=0,particleGeometry.color.array[4*i+2]=0,particleGeometry.color.array[4*i+3]=0}return particleGeometry.position.needsUpdate=!0,particleGeometry.color.needsUpdate=!0,particleGeometry.data=sightings,particleGeometry}},{key:"renderMembers",value:function(geometry,screenBounds,_expedition,_gb){var _this5=this;return this.simpleState.members?Object.keys(this.simpleState.members).map(function(name){var member=_this5.simpleState.members[name],position=_this5.mapToScreen(member.coordinates,screenBounds);return{name:name,position:position}}):geometry}},{key:"render",value:function(){var _props2=this.props,expedition=_props2.expedition,show360Picture=_props2.show360Picture,lightBoxActive=_props2.lightBoxActive,_simpleState=this.simpleState,viewport=_simpleState.viewport,currentDate=_simpleState.currentDate,MAPBOX_ACCESS_TOKEN="pk.eyJ1IjoiaWFhYWFuIiwiYSI6ImNpbXF1ZW4xOTAwbnl3Ymx1Y2J6Mm5xOHYifQ.6wlNzSdcTlonLBH-xcmUdQ",MAPBOX_STYLE="mapbox://styles/mapbox/satellite-v9?format=jpg70";return _react2.default.createElement("div",{id:"mapbox",style:{zIndex:lightBoxActive||"/map"!==location.pathname&&"/"!==location.pathname?-100:0}},_react2.default.createElement(_reactMapGl2.default,_extends({},viewport,{mapStyle:MAPBOX_STYLE,mapboxApiAccessToken:MAPBOX_ACCESS_TOKEN}),expedition?_react2.default.createElement("div",null,_react2.default.createElement(_WebGLOverlay2.default,_extends({},viewport,{startDragLngLat:[0,0],redraw:this.redrawGLOverlay,show360Picture:show360Picture,currentDate:currentDate}))):""))}}]),BackgroundMap}(_react2.default.Component),_applyDecoratedDescriptor(_class.prototype,"tick",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"tick"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"redrawGLOverlay",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"redrawGLOverlay"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"mapToScreen",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"mapToScreen"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"renderAmbitGeo",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"renderAmbitGeo"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"render360Images",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"render360Images"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"renderSightings",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"renderSightings"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"renderMembers",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"renderMembers"),_class.prototype),_class);BackgroundMap.propTypes={animate:_react.PropTypes.bool.isRequired,expedition:_react.PropTypes.object,updateMap:_react.PropTypes.func.isRequired,fetchDay:_react.PropTypes.func.isRequired,setControl:_react.PropTypes.func.isRequired,mapStateNeedsUpdate:_react.PropTypes.bool.isRequired,contentActive:_react.PropTypes.bool,show360Picture:_react.PropTypes.func.isRequired,lightBoxActive:_react.PropTypes.bool.isRequired},exports.default=BackgroundMap},445:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_YearSelector=__webpack_require__(466),_DateSelector=(_interopRequireDefault(_YearSelector),__webpack_require__(448)),_DateSelector2=_interopRequireDefault(_DateSelector),_PlaybackSelector=__webpack_require__(461),_PlaybackSelector2=_interopRequireDefault(_PlaybackSelector),_FocusSelector=__webpack_require__(450),_ZoomSelector=(_interopRequireDefault(_FocusSelector),__webpack_require__(467)),_LayoutSelector=(_interopRequireDefault(_ZoomSelector),__webpack_require__(453)),ControlPanel=(_interopRequireDefault(_LayoutSelector),function(_ref){var pathName=_ref.pathName,expeditionID=_ref.expeditionID,expeditions=_ref.expeditions,currentDate=_ref.currentDate,playback=_ref.playback,onPlaybackChange=(_ref.mainFocus,_ref.secondaryFocus,_ref.zoom,_ref.layout,_ref.onYearChange,_ref.onPlaybackChange);_ref.onMainFocusChange,_ref.onSecondaryFocusChange,_ref.onZoomChange,_ref.onLayoutChange,_ref.viewport;return expeditionID?("/"===pathName&&(pathName="/map"),_react2.default.createElement("div",{className:"controlPanel"},_react2.default.createElement(_DateSelector2.default,{expeditions:expeditions,expeditionID:expeditionID,currentDate:currentDate}),"/map"===pathName?_react2.default.createElement(_PlaybackSelector2.default,{mode:playback,onPlaybackChange:onPlaybackChange}):null)):_react2.default.createElement("div",{className:"controlPanel"})});ControlPanel.propTypes={pathName:_react.PropTypes.string.isRequired,expeditionID:_react.PropTypes.string,expeditions:_react.PropTypes.object,currentDate:_react.PropTypes.object,playback:_react.PropTypes.string,mainFocus:_react.PropTypes.string,secondaryFocus:_react.PropTypes.string,zoom:_react.PropTypes.number,layout:_react.PropTypes.string,onYearChange:_react.PropTypes.func.isRequired,onPlaybackChange:_react.PropTypes.func.isRequired,onMainFocusChange:_react.PropTypes.func.isRequired,onSecondaryFocusChange:_react.PropTypes.func.isRequired,onZoomChange:_react.PropTypes.func.isRequired,onLayoutChange:_react.PropTypes.func.isRequired,viewPort:_react.PropTypes.object},exports.default=ControlPanel},446:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_DataPageIndex=__webpack_require__(447),_DataPageIndex2=_interopRequireDefault(_DataPageIndex),_APIExplorer=__webpack_require__(442),DataPage=(_interopRequireDefault(_APIExplorer),function(){var sections=[{key:1,title:"Overview",content:_react2.default.createElement("div",null,_react2.default.createElement("p",null,"The Okavango Database is a growing record of data generated by the explorers and scientists on their 120 day expedition to the Okavango Delta. The database encompasses ",_react2.default.createElement("em",null,"wildlife sightings, tweets, audio recordings")," and ",_react2.default.createElement("em",null,"images")," taken by the participants, as well as ",_react2.default.createElement("em",null,"sensor measurements")," capturing things like ",_react2.default.createElement("em",null,"temperature, pH levels, and heart rates"),"."),_react2.default.createElement("p",null,"The intention of the Okavango Database API is to share the data in almost real-time as it’s uploaded, so that people all over the world can follow the journey as it unfolds. It also allows for others to use the data for their own purposes. Below are examples of cool things people have build with our API."))},{key:2,title:"Documentation",content:_react2.default.createElement("div",null,_react2.default.createElement("h3",null,"What is an API?"),_react2.default.createElement("p",null,"API stands for application programming interface, which usually involves a set of processes and commands that make it convenient for people to access computer code or information that someone has already produced. For instance, if you want to make your own app post a message to Facebook, you would probably use Facebook’s API to integrate your app with theirs."),_react2.default.createElement("h3",null,"What is a Database?"),_react2.default.createElement("p",null,"A database is an organized collection of data. For the Okavango Wildlife Database, each type of data — a wildlife sighting, image, sensor reading or audio recording, to name a few — is uploaded to an online server via satellite. As the expedition unfolds, the database will grow, holding more and more records of what the explorers and scientists have witnessed on the trip."),_react2.default.createElement("h3",null,"What is a Database API?"),_react2.default.createElement("p",null,"The Okavango Database API is the interface that allows you to ask the database to show you what’s inside. Usually, API’s are software-to-software interfaces that aren’t that easy for humans to understand. To ask the database to give you data back, you make a specific query in the form of a URL. The database is able to parse and recognize this request, and returns the data to you in some kind of structured way, like an XML or JSON file. In our case, the Okavango Database returns information in JSON (Javascript Object Notation)."),_react2.default.createElement("h3",null,"Calling the API"),_react2.default.createElement("p",null,"Basically, it's like this: ",_react2.default.createElement("code",null,"/api/<view>/<output>?<query>")),_react2.default.createElement("p",null,"The view is what kind of thing you want back. The core of the API lies in the features view, but you can also view expeditions, members and species as general lists."),_react2.default.createElement("p",null,"The output returns the data as JSON if nothing is specified, otherwise you can specify ",_react2.default.createElement("code",null,"map")," to see the data plotted spatially or ",_react2.default.createElement("code",null,"viz")," for a graph."),_react2.default.createElement("p",null,"The query defines the filter (ex: ",_react2.default.createElement("code",null,"FeatureType=sighting"),"). Multiple filters are appended with ",_react2.default.createElement("code",null,"&")," in between."),_react2.default.createElement("h3",null,"API Endpoints"),_react2.default.createElement("p",null,"The following list outlines all possible methods for accessing features in the Okavango Database. These methods are also known as endpoints, and are requested with a URL. For example, to load all of the elephant sightings (limited to the first 100 by default), you would request: ",_react2.default.createElement("code",null,_react2.default.createElement("a",{href:"http://data.intotheokavango.org/api/features?FeatureType=sighting&SpeciesName=Elephant",target:"_blank"},"http://data.intotheokavango.org/api/features?FeatureType=sighting&SpeciesName=Elephant"))),_react2.default.createElement("p",null,"The Elephant sightings could be filtered further, by the expedition member who saw them, geographic region, or day of expedition, for example. Each API endpoint call contains the following general information:"),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"limit:")," the amount of entries returned. The default limit is 100, but this can be changed (ex: ",_react2.default.createElement("code",null,"limit=30"),"). Larger limits tax the database, so it is recommended to keep your limit request as small as possible."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"resolution:")," returns a feature for every ",_react2.default.createElement("code",null,"resolution")," seconds. This might be useful if you want a larger sample set or time period, but don’t want to overload a graph with every single data point. ",_react2.default.createElement("code",null,"full")," returns all features."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"filter:")," feature endpoints can be filtered by member, expedition, as well as general filters like ",_react2.default.createElement("code",null,"limit, resolution,")," and ",_react2.default.createElement("code",null,"order.")),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"returned:")," the amount of entries returned (this usually correlates to limit, but may be less than the limit indicated if there are fewer results in the database)."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"order:")," results are returned by default in ascending order (indicated by setting ",_react2.default.createElement("code",null,"order")," to ",_react2.default.createElement("code",null,"ascending")," or ",_react2.default.createElement("code",null,"1"),"), or descending order (indicated by setting ",_react2.default.createElement("code",null,"order")," to ",_react2.default.createElement("code",null,"descending")," or ",_react2.default.createElement("code",null,"-1"),")."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"total:")," indicates the total amount of matching results for the query in the database, even if the amount returned is limited."),_react2.default.createElement("h4",null,"Additional Filters:"),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"startDate:")," specifies the starting date of the features to be returned. May be combined with ",_react2.default.createElement("code",null,"endDate.")," Format is ",_react2.default.createElement("code",null,"yyyy-mm-dd")," (ex: ",_react2.default.createElement("code",null,"startDate=2015-06-03"),")."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"endDate:")," specifies the ending date of the features to be returned. May be combined with ",_react2.default.createElement("code",null,"startDate.")," Format is ",_react2.default.createElement("code",null,"yyyy-mm-dd")," (ex: ",_react2.default.createElement("code",null,"endDate=2015-06-03"),")."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"geoBounds:")," upper left (NW), lower right (SE): lon_1,lat_1,lon_2,lat_2. So the Okavango Delta is something like ",_react2.default.createElement("code",null,"geoBounds=20,-17,26,-22")),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"expeditionDay:")," returns data from a specific day of the expedition (ex: ",_react2.default.createElement("code",null,"expeditionDay=1"),")"),_react2.default.createElement("h4",null,"View Endpoints:"),_react2.default.createElement("p",null,"These endpoints offer overviews of all the members, expeditions and species that could be used to further filter features in the database."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"members:")," reveals an array of features associated with each member. Endpoint url: ",_react2.default.createElement("code",null,_react2.default.createElement("a",{href:"http://data.intotheokavango.org/api/members",target:"_blank"},"http://data.intotheokavango.org/api/members"))),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"expeditions:")," reveals all of the expeditions to the Okavango Delta, along with start date and duration. Endpoint url: ",_react2.default.createElement("code",null,_react2.default.createElement("a",{
href:"http://data.intotheokavango.org/api/expeditions",target:"_blank"},"http://data.intotheokavango.org/api/expeditions"))),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"species:")," reveals all of the species sightings on the expeditions. Endpoint url: ",_react2.default.createElement("code",null,_react2.default.createElement("a",{href:"http://data.intotheokavango.org/api/species",target:"_blank"},"http://data.intotheokavango.org/api/species"))),_react2.default.createElement("h4",null,"Features Endpoints:"),_react2.default.createElement("p",null,"If you try to call the features view, the format looks quite different from the other view endpoints. This is because the Features view contains the bulk of what’s in the database, and is the main collection to be searched and filtered."),_react2.default.createElement("p",null,"The primary way to filter the features is by ",_react2.default.createElement("code",null,"FeatureType")," (ex: ",_react2.default.createElement("code",null,"FeatureType=ambit"),")."),_react2.default.createElement("p",null,"Here is a list of the possible FeatureTypes, and the data they contain: "),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"ambit:")," contains heart rate and other activity data captured from ambit watches worn by certain explorers."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"ambit_geo:")," contains geolocation data from the ambit watches."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"audio:")," audio recordings taken in the field."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"beacon:")," geolocation data sent by beacons every 30 minutes."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"image:")," all images uploaded to the database. These can be filtered further by ",_react2.default.createElement("code",null,"ImageType: GoPro, Documentary")," or ",_react2.default.createElement("code",null,"Specimen.")),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"sensor:")," sensor readings taken by environmental sensors attached to the expedition boat. Data includes temperature, pH levels and other environmental readings."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"sighting:")," all species sightings on the expedition. You can further filter by ",_react2.default.createElement("code",null,"SpeciesName")," (ex: ",_react2.default.createElement("code",null,"SpeciesName=Elephant"),"). The results return a timestamped geolocated point, with a ",_react2.default.createElement("code",null,"Count")," of how many species were sighted, as well as images if they were taken. A ",_react2.default.createElement("code",null,"Taxonomy")," object returns the scientific name, and a ",_react2.default.createElement("code",null,"Notes")," field records a description uploaded with the sighting."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"tweet:")," a list of all tweets with the hashtag #okavango15."),_react2.default.createElement("p",null,_react2.default.createElement("code",null,"longform:")," returns longform blog entries posted to the okavango collection on ",_react2.default.createElement("a",{href:"https://medium.com/tag/okavango15",target:"_blank"},"Medium.")))}],index=sections.map(function(section){return _react2.default.createElement("h3",{key:section.key},section.key," - ",section.title)}),content=sections.map(function(section){return _react2.default.createElement("div",{key:section.key},_react2.default.createElement("h2",null,section.key," - ",section.title),section.content)});return _react2.default.createElement("div",{className:"page",id:"dataPage"},_react2.default.createElement(_DataPageIndex2.default,null,index),_react2.default.createElement("div",{id:"dataPageContent"},content))});DataPage.propTypes={},exports.default=DataPage},447:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),DataPageIndex=function(_ref){var children=_ref.children;return _react2.default.createElement("div",{id:"APIIndex"},children)};DataPageIndex.propTypes={children:_react.PropTypes.node.isRequired},exports.default=DataPageIndex},448:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_utils=__webpack_require__(67),DateSelector=function(_ref){var expeditions=_ref.expeditions,expeditionID=_ref.expeditionID,currentDate=_ref.currentDate,expedition=expeditions[expeditionID],dayCount=Math.floor((currentDate.getTime()-expedition.start.getTime())/864e5)+1,dateString=(0,_utils.dateToString)(currentDate);return _react2.default.createElement("div",{className:"dateSelector controlSelector"},_react2.default.createElement("p",null,"DAY ",dayCount,_react2.default.createElement("br",null),dateString))};DateSelector.propTypes={expeditions:_react.PropTypes.object.isRequired,expeditionID:_react.PropTypes.string.isRequired,currentDate:_react.PropTypes.object.isRequired},exports.default=DateSelector},449:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_Post=__webpack_require__(271),_Post2=_interopRequireDefault(_Post),_d=__webpack_require__(87),_autobindDecorator=(_interopRequireWildcard(_d),__webpack_require__(66)),Feed=(_interopRequireDefault(_autobindDecorator),function(_React$Component){function Feed(props){return _classCallCheck(this,Feed),_possibleConstructorReturn(this,(Feed.__proto__||Object.getPrototypeOf(Feed)).call(this,props))}return _inherits(Feed,_React$Component),_createClass(Feed,[{key:"render",value:function(){var _props=this.props,posts=_props.posts,checkFeedContent=_props.checkFeedContent,format="full",postFeed=posts.slice(0).sort(function(a,b){return b.date-a.date}).map(function(post){return"360Image"===post.type?null:_react2.default.createElement(_Post2.default,{format:format,data:post,key:post.key},post.content)});return _react2.default.createElement("div",{id:"feed",onWheel:checkFeedContent},postFeed)}}]),Feed}(_react2.default.Component));Feed.propTypes={posts:_react.PropTypes.array.isRequired,expedition:_react.PropTypes.object,checkFeedContent:_react.PropTypes.func.isRequired},exports.default=Feed},450:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),FocusSelector=function(_ref){var mainFocus=_ref.mainFocus,secondaryFocus=_ref.secondaryFocus,onMainFocusChange=_ref.onMainFocusChange,onSecondaryFocusChange=_ref.onSecondaryFocusChange,toggleDropdown=function(i){document.getElementById("FocusSelector"+i+"Options").classList.toggle("show")};return _react2.default.createElement("div",{className:"focusSelector controlSelector"},_react2.default.createElement("p",null,"Focus on:"),_react2.default.createElement("div",{className:"dropdown"},_react2.default.createElement("button",{onClick:function(){return toggleDropdown(1)},className:"dropbtn"},mainFocus),_react2.default.createElement("div",{id:"FocusSelector1Options",className:"dropdown-content"},_react2.default.createElement("a",{href:"#",onClick:function(){return onMainFocusChange("explorers")}},"Explorers"),_react2.default.createElement("a",{href:"#",onClick:function(){return onMainFocusChange("sensors")}},"Sensors"),_react2.default.createElement("a",{href:"#",onClick:function(){return onMainFocusChange("animals")}},"Animals"))),_react2.default.createElement("div",{className:"dropdown"},_react2.default.createElement("button",{onClick:function(){return toggleDropdown(2)},className:"dropbtn"},secondaryFocus),_react2.default.createElement("div",{id:"FocusSelector2Options",className:"dropdown-content"},_react2.default.createElement("a",{href:"#",onClick:function(){return onSecondaryFocusChange("steve")}},"Steve"),_react2.default.createElement("a",{href:"#",onClick:function(){return onSecondaryFocusChange("jer")}},"Jer"),_react2.default.createElement("a",{href:"#",onClick:function(){return onSecondaryFocusChange("shah")}},"Shah"),_react2.default.createElement("a",{href:"#",onClick:function(){return onSecondaryFocusChange("chris")}},"Chris"))))};FocusSelector.propTypes={mainFocus:_react.PropTypes.string.isRequired,secondaryFocus:_react.PropTypes.string.isRequired,onMainFocusChange:_react.PropTypes.func.isRequired,onSecondaryFocusChange:_react.PropTypes.func.isRequired},exports.default=FocusSelector},451:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};return Object.keys(descriptor).forEach(function(key){desc[key]=descriptor[key]}),desc.enumerable=!!desc.enumerable,desc.configurable=!!desc.configurable,("value"in desc||desc.initializer)&&(desc.writable=!0),desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc},desc),context&&void 0!==desc.initializer&&(desc.value=desc.initializer?desc.initializer.call(context):void 0,desc.initializer=void 0),void 0===desc.initializer&&(Object.defineProperty(target,property,desc),desc=null),desc}Object.defineProperty(exports,"__esModule",{value:!0});var _class,_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_TransitionGroup=__webpack_require__(1048),_TransitionGroup2=_interopRequireDefault(_TransitionGroup),_CSSTransition=__webpack_require__(1046),_CSSTransition2=_interopRequireDefault(_CSSTransition),_autobindDecorator=__webpack_require__(66),_autobindDecorator2=_interopRequireDefault(_autobindDecorator),IntroductionBox=(_class=function(_React$Component){function IntroductionBox(props){_classCallCheck(this,IntroductionBox);var _this=_possibleConstructorReturn(this,(IntroductionBox.__proto__||Object.getPrototypeOf(IntroductionBox)).call(this,props));return _this.state={complete:!1,contentEnabled:!1,startDate:-1,currentPosts:[],posts:[{content:_react2.default.createElement("p",{key:"0"}),timeRange:[0,4e3]},{content:_react2.default.createElement("p",{key:"1"},"Beginning in 2015,a group of Ba'yei, scientists and explorers have been exploring the Okavango River System in traditional flat-bottomed boats, gathering crucial biodiversity and environmental data."),timeRange:[4e3,11e3]},{content:_react2.default.createElement("p",{key:"2"},"You can use this platform to explore what the team saw and experienced on their last expedition through this verdant and vitally important ecosystem."),timeRange:[11e3,19e3]}]},_this}return _inherits(IntroductionBox,_React$Component),_createClass(IntroductionBox,[{key:"skip",value:function(){var enableContent=this.props.enableContent;this.state.complete=!0,this.state.contentEnabled=!0,enableContent()}},{key:"tick",value:function(){var enableContent=this.props.enableContent,_state=this.state,posts=_state.posts,startDate=_state.startDate;if("/map"!==location.pathname&&"/"!==location.pathname)return void requestAnimationFrame(this.tick);if(startDate===-1)return this.setState(_extends({},this.state,{startDate:Date.now()})),void requestAnimationFrame(this.tick);var now=Date.now()-startDate,currentPosts=[];posts.forEach(function(p){p.timeRange[0]<=now&&p.timeRange[1]>now&&currentPosts.push(p)}),now>posts[posts.length-1].timeRange[1]-6e3&&!this.state.contentEnabled&&(this.state.contentEnabled=!0,enableContent());var flag=!0;if(currentPosts.length!==this.state.currentPosts.length)flag=!1;else for(var i=0;i<Math.max(currentPosts.length,this.state.currentPosts.length);i++)if(currentPosts[i]!==this.state.currentPosts[i]){flag=!1;break}return flag||this.setState(_extends({},this.state,{currentPosts:currentPosts})),now>posts[posts.length-1].timeRange[1]?void(this.state.complete=!0):void requestAnimationFrame(this.tick)}},{key:"componentDidMount",value:function(){requestAnimationFrame(this.tick)}},{key:"render",value:function(){var _state2=this.state,currentPosts=_state2.currentPosts,complete=_state2.complete,posts=(this.props.animate,currentPosts.map(function(p,i){return _react2.default.createElement(_CSSTransition2.default,{key:i,classNames:"notif",timeout:{exit:200,enter:500}},_react2.default.createElement("div",null,p.content))})),container=function(){return _react2.default.createElement(_TransitionGroup2.default,null,posts)};return complete?_react2.default.createElement("div",null):_react2.default.createElement("div",{id:"IntroductionBox"},container())}}]),IntroductionBox}(_react2.default.Component),_applyDecoratedDescriptor(_class.prototype,"skip",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"skip"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"tick",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"tick"),_class.prototype),_class);IntroductionBox.propTypes={enableContent:_react.PropTypes.func.isRequired,animate:_react.PropTypes.bool.isRequired},exports.default=IntroductionBox},452:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_Feed=__webpack_require__(449),_Feed2=_interopRequireDefault(_Feed),_ControlPanelContainer=__webpack_require__(272),_ControlPanelContainer2=_interopRequireDefault(_ControlPanelContainer),JournalPage=function(_React$Component){function JournalPage(){return _classCallCheck(this,JournalPage),_possibleConstructorReturn(this,(JournalPage.__proto__||Object.getPrototypeOf(JournalPage)).apply(this,arguments))}return _inherits(JournalPage,_React$Component),_createClass(JournalPage,[{key:"render",value:function(){var _props=this.props,posts=_props.posts,checkFeedContent=_props.checkFeedContent,expedition=_props.expedition;return _react2.default.createElement("div",{className:"page",id:"journalPage"},_react2.default.createElement(_ControlPanelContainer2.default,{pathName:location.pathname}),_react2.default.createElement(_Feed2.default,{posts:posts,checkFeedContent:checkFeedContent,expedition:expedition}))}}]),JournalPage}(_react2.default.Component);JournalPage.propTypes={posts:_react.PropTypes.array.isRequired,expedition:_react.PropTypes.object,checkFeedContent:_react.PropTypes.func.isRequired},exports.default=JournalPage},453:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),LayoutSelector=function(_ref){var mode=_ref.mode,onLayoutChange=_ref.onLayoutChange,types=["rows","grid"],buttons=types.map(function(s,i){var className="layoutButton "+(s===mode?"active":"inactive");return _react2.default.createElement("li",{className:className,key:i,onClick:function(){return onLayoutChange(s)}},_react2.default.createElement("img",{width:"16",height:"16"}))});return _react2.default.createElement("div",{className:"selector"},_react2.default.createElement("div",{className:"column"},_react2.default.createElement("ul",{className:"buttonRow"},buttons)))};LayoutSelector.propTypes={onLayoutChange:_react.PropTypes.func.isRequired,mode:_react.PropTypes.string.isRequired},exports.default=LayoutSelector},454:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_Post=__webpack_require__(271),_Post2=_interopRequireDefault(_Post),LightBox=function(props){var active=props.active,post=props.post,closeLightBox=props.closeLightBox,show360Picture=props.show360Picture,height={height:window.innerHeight-200};return active&&post?_react2.default.createElement("div",{id:"lightBox"},_react2.default.createElement("div",{id:"feed",style:height},_react2.default.createElement(_Post2.default,{format:"full",data:post,closeLightBox:closeLightBox,show360Picture:show360Picture},post.content))):null};LightBox.propTypes={active:_react.PropTypes.bool.isRequired,post:_react.PropTypes.object,closeLightBox:_react.PropTypes.func.isRequired,show360Picture:_react.PropTypes.func.isRequired},exports.default=LightBox},455:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_NotificationPanelContainer=__webpack_require__(469),_NotificationPanelContainer2=_interopRequireDefault(_NotificationPanelContainer),_ControlPanelContainer=__webpack_require__(272),_ControlPanelContainer2=_interopRequireDefault(_ControlPanelContainer),MapPage=function(){var height={height:window.innerWidth>768?window.innerHeight-100:window.innerHeight-120};return _react2.default.createElement("div",{className:"page",id:"mapPage",style:height},_react2.default.createElement(_ControlPanelContainer2.default,{pathName:location.pathname}),_react2.default.createElement(_NotificationPanelContainer2.default,null))};exports.default=MapPage},456:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_NavigationItem=__webpack_require__(457),_NavigationItem2=_interopRequireDefault(_NavigationItem),Navigation=function(_ref){var pathName=_ref.pathName,setPage=_ref.setPage,activeLinks=_ref.activeLinks;return _react2.default.createElement("div",{id:"header"},_react2.default.createElement("div",{id:"navigation"},_react2.default.createElement("ul",null,_react2.default.createElement(_NavigationItem2.default,{enabled:activeLinks,setPage:setPage,active:"/"===pathName||"/map"===pathName},"Map"),_react2.default.createElement(_NavigationItem2.default,{enabled:activeLinks,setPage:setPage,active:"/journal"===pathName},"Journal"),_react2.default.createElement(_NavigationItem2.default,{enabled:activeLinks,setPage:setPage,active:"/about"===pathName},"About"))),_react2.default.createElement("h1",null,"INTO THE OKAVANGO"),_react2.default.createElement("img",{id:"logo",src:"static/img/logo.svg",alt:"Into the Okavango"}))};Navigation.propTypes={pathName:_react.PropTypes.string.isRequired,setPage:_react.PropTypes.func.isRequired,activeLinks:_react.PropTypes.bool},exports.default=Navigation},457:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_reactRouter=__webpack_require__(402),NavigationItem=function(_ref){var children=_ref.children,active=_ref.active,setPage=_ref.setPage,enabled=_ref.enabled;return setPage||(setPage=function(){}),enabled?_react2.default.createElement("li",{className:active?"active":"",onClick:setPage},_react2.default.createElement(_reactRouter.Link,{to:children.toString().toLowerCase()},children.toString())):_react2.default.createElement("li",{className:"disabled "+(active?"active":"")},_react2.default.createElement("span",null,children.toString()))};NavigationItem.propTypes={children:_react.PropTypes.node.isRequired,setPage:_react.PropTypes.func,active:_react.PropTypes.bool.isRequired,enabled:_react.PropTypes.bool.isRequired},exports.default=NavigationItem},458:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),Notification=function(_ref){var children=_ref.children,type=_ref.type,active=_ref.active,id=_ref.id;return _react2.default.createElement("div",{className:"notification n"+id+(active?"":" inactive")},_react2.default.createElement("div",{className:"content"},children),_react2.default.createElement("div",{className:"type"},_react2.default.createElement("img",{width:"16",height:"16",src:"static/img/icon-"+type+".png"})))};Notification.propTypes={children:_react.PropTypes.node.isRequired,type:_react.PropTypes.string.isRequired,active:_react.PropTypes.bool,id:_react.PropTypes.string.isRequired},exports.default=Notification},459:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(242),_reactDom2=_interopRequireDefault(_reactDom),_Notification=__webpack_require__(458),_Notification2=_interopRequireDefault(_Notification),_utils=__webpack_require__(67),NotificationPanel=function(_React$Component){function NotificationPanel(props){_classCallCheck(this,NotificationPanel);var _this=_possibleConstructorReturn(this,(NotificationPanel.__proto__||Object.getPrototypeOf(NotificationPanel)).call(this,props));return _this.state={notifications:[],currentNotifications:[],posY:0},_this}return _inherits(NotificationPanel,_React$Component),_createClass(NotificationPanel,[{key:"componentWillReceiveProps",value:function(nextProps){var posts=nextProps.posts,currentDate=nextProps.currentDate;if(posts){var start=void 0,end=void 0;currentDate&&(start=new Date(currentDate.getTime()-9e5),end=new Date(currentDate.getTime()+9e5));var notifications=posts.filter(function(post){return"image"!==post.type||"RICOH"!==post.properties.Make}).sort(function(a,b){return(0,_utils.parseDate)(a.properties.DateTime).getTime()-(0,_utils.parseDate)(b.properties.DateTime).getTime()}),currentNotifications=notifications.filter(function(post){var d=(0,_utils.parseDate)(post.properties.DateTime);return d.getTime()>=start&&d.getTime()<end});this.setState(_extends({},this.state,{notifications:notifications,currentNotifications:currentNotifications}))}}},{key:"shouldComponentUpdate",value:function(nextProps,nextState){var currentProperties=_extends({},this.props,this.state),nextProperties=_extends({},nextProps,nextState);return Object.keys(currentProperties).some(function(p){return currentProperties[p]!==nextProperties[p]})}},{key:"componentDidUpdate",value:function(){var _this2=this,_state=this.state,notifications=_state.notifications,currentNotifications=_state.currentNotifications,_props=this.props,currentDate=_props.currentDate,playback=_props.playback;if(currentNotifications&&currentNotifications.length>0)currentNotifications.filter(function(notification,i){return 0===i}).some(function(notification){return _this2.setState(_extends({},_this2.state,{posY:-1*_reactDom2.default.findDOMNode(_this2).querySelector("div.notification.n"+notification.id).offsetTop}))});else{var forward="fastForward"===playback||"forward"===playback||"pause"===playback;if(forward)for(var i=0;i<notifications.length;i++){var notification=notifications[i],d=(0,_utils.parseDate)(notification.properties.DateTime);if(d.getTime()>currentDate.getTime())return this.setState(_extends({},this.state,{posY:-1*_reactDom2.default.findDOMNode(this).querySelector("div.notification.n"+notification.id).offsetTop}))}else for(var _i=notifications.length-1;_i>=0;_i--){var _notification=notifications[_i],_d=(0,_utils.parseDate)(_notification.properties.DateTime);if(_d.getTime()<currentDate.getTime())return this.setState(_extends({},this.state,{posY:-1*_reactDom2.default.findDOMNode(this).querySelector("div.notification.n"+_notification.id).offsetTop}))}}}},{key:"render",value:function(){var _state2=this.state,notifications=_state2.notifications,currentNotifications=_state2.currentNotifications,notificationItems=notifications.filter(function(post,i){return window.innerWidth>768||currentNotifications.indexOf(post)===currentNotifications.length-1}).map(function(post,i){var active=currentNotifications.indexOf(post)>-1;switch(post.type){case"tweet":var text=post.properties.Text;text=text.split(" ").slice(0,text.split(" ").length-1).join(" "),post.properties.Tweet&&(text=post.properties.Tweet.text);var images=post.properties.Images.filter(function(img,j){return 0===j}).map(function(img,j){return _react2.default.createElement("img",{src:active?img.Url.replace("http://","https://"):"#",width:"100%",key:j})});return _react2.default.createElement(_Notification2.default,{type:post.type,key:post.id,active:active,id:post.id},_react2.default.createElement("p",{style:{position:window.innerWidth>768||0===post.properties.Images.length?"relative":"absolute"}},text),_react2.default.createElement("div",{className:"images"},images));case"audio":return _react2.default.createElement(_Notification2.default,{type:post.type,key:post.id,id:post.id,active:active},_react2.default.createElement("div",{className:"title"},post.properties.Title));case"blog":return _react2.default.createElement(_Notification2.default,{type:post.type,key:post.id,id:post.id,active:active},_react2.default.createElement("div",{className:"title"},post.properties.Title));case"image":var width=0,height=0;return post.properties.Dimensions?(width=post.properties.Dimensions[0],height=post.properties.Dimensions[1]):post.properties.Size&&(width=post.properties.Size[0],
height=post.properties.Size[1]),_react2.default.createElement(_Notification2.default,{type:post.type,key:post.id,id:post.id,active:currentNotifications.indexOf(post)>-1},_react2.default.createElement("img",{className:"image",src:active?post.properties.Url.replace("http://","https://"):"#",width:width,height:height}))}}),height=window.innerWidth>768?{height:window.innerHeight-110}:{};return _react2.default.createElement("div",{id:"notificationPanel",style:height},_react2.default.createElement("div",{className:"scrollableContainer",style:{top:this.state.posY}},notificationItems))}}]),NotificationPanel}(_react2.default.Component);NotificationPanel.propTypes={posts:_react.PropTypes.array,currentDate:_react.PropTypes.object,playback:_react.PropTypes.string},exports.default=NotificationPanel},460:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_BackgroundMap=__webpack_require__(444),_BackgroundMap2=_interopRequireDefault(_BackgroundMap),_LightBox=__webpack_require__(454),_LightBox2=_interopRequireDefault(_LightBox),_Timeline=__webpack_require__(464),_Timeline2=_interopRequireDefault(_Timeline),_Navigation=__webpack_require__(456),_Navigation2=_interopRequireDefault(_Navigation),_IntroductionBox=__webpack_require__(451),_IntroductionBox2=_interopRequireDefault(_IntroductionBox),Okavango=function(_React$Component){function Okavango(){return _classCallCheck(this,Okavango),_possibleConstructorReturn(this,(Okavango.__proto__||Object.getPrototypeOf(Okavango)).apply(this,arguments))}return _inherits(Okavango,_React$Component),_createClass(Okavango,[{key:"render",value:function(){var _props=this.props,children=_props.children,expedition=_props.expedition,animate=_props.animate,updateMap=_props.updateMap,fetchDay=_props.fetchDay,setControl=_props.setControl,jumpTo=_props.jumpTo,isFetching=_props.isFetching,isInitialLoad=_props.isInitialLoad,mapStateNeedsUpdate=_props.mapStateNeedsUpdate,setPage=_props.setPage,expeditionID=_props.expeditionID,contentActive=_props.contentActive,enableContent=_props.enableContent,show360Picture=_props.show360Picture,lightBoxActive=_props.lightBoxActive,lightBoxPost=_props.lightBoxPost,closeLightBox=_props.closeLightBox,height={height:window.innerWidth>768?window.innerHeight-100:window.innerHeight-120};return _react2.default.createElement("div",{id:"root"},_react2.default.createElement(_BackgroundMap2.default,{expeditionID:expeditionID,isFetching:isFetching,animate:animate,expedition:expedition,updateMap:updateMap,fetchDay:fetchDay,setControl:setControl,mapStateNeedsUpdate:mapStateNeedsUpdate,contentActive:contentActive,show360Picture:show360Picture,lightBoxActive:lightBoxActive}),_react2.default.createElement("div",{id:"nightOverlay",style:{opacity:"/map"!==location.pathname&&"/"!==location.pathname||lightBoxActive?1:0,zIndex:lightBoxActive?1:0}}),_react2.default.createElement("div",{id:"loadingWheel",className:"/about"===location.pathname||!isInitialLoad&&!isFetching&&enableContent&&animate?"hidden":"visible"},_react2.default.createElement("div",{className:"wheel"})),_react2.default.createElement(_Navigation2.default,{activeLinks:!isInitialLoad&&contentActive,setPage:setPage,pathName:location.pathname}),_react2.default.createElement("div",{id:"content",style:height,className:contentActive?"":"hidden",onMouseDown:function(){lightBoxActive&&closeLightBox()}},_react2.default.createElement(_Timeline2.default,{expeditionID:expeditionID,expedition:expedition,jumpTo:jumpTo}),_react2.default.createElement("div",{id:"pageContainer",className:"/map"===location.pathname||"/"===location.pathname?"disabled":""},_react2.default.createElement(_LightBox2.default,{active:lightBoxActive,post:lightBoxPost,closeLightBox:closeLightBox,show360Picture:show360Picture}),children),_react2.default.createElement("div",{className:"logos",style:{display:"/map"===location.pathname||"/"===location.pathname?"block":"none"}},_react2.default.createElement("a",{href:"https://www.nationalgeographic.org/"},_react2.default.createElement("img",{src:"static/img/natgeoLogo.svg",alt:"National Geographic Logo",height:"35px"})),_react2.default.createElement("a",{href:"http://www.o-c-r.org/"},_react2.default.createElement("img",{src:"static/img/ocrLogo.svg",alt:"The Office for Creative Research Logo",height:"35px"})),_react2.default.createElement("a",{href:"http://www.wildbirdtrust.com/"},_react2.default.createElement("img",{src:"static/img/wbtLogo.png",alt:"Wild Bird Trust Logo",height:"35px"})))),_react2.default.createElement(_IntroductionBox2.default,{enableContent:enableContent,animate:animate}))}}]),Okavango}(_react2.default.Component);exports.default=Okavango,Okavango.propTypes={animate:_react.PropTypes.bool,children:_react.PropTypes.node.isRequired,expedition:_react.PropTypes.object,expeditionID:_react.PropTypes.string,updateMap:_react.PropTypes.func.isRequired,fetchDay:_react.PropTypes.func.isRequired,setControl:_react.PropTypes.func.isRequired,jumpTo:_react.PropTypes.func.isRequired,isFetching:_react.PropTypes.bool.isRequired,mapStateNeedsUpdate:_react.PropTypes.bool.isRequired,setPage:_react.PropTypes.func.isRequired,contentActive:_react.PropTypes.bool.isRequired,enableContent:_react.PropTypes.func.isRequired,show360Picture:_react.PropTypes.func.isRequired,lightBoxActive:_react.PropTypes.bool.isRequired,lightBoxPost:_react.PropTypes.object,closeLightBox:_react.PropTypes.func.isRequired}},461:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};return Object.keys(descriptor).forEach(function(key){desc[key]=descriptor[key]}),desc.enumerable=!!desc.enumerable,desc.configurable=!!desc.configurable,("value"in desc||desc.initializer)&&(desc.writable=!0),desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc},desc),context&&void 0!==desc.initializer&&(desc.value=desc.initializer?desc.initializer.call(context):void 0,desc.initializer=void 0),void 0===desc.initializer&&(Object.defineProperty(target,property,desc),desc=null),desc}Object.defineProperty(exports,"__esModule",{value:!0});var _class,_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_autobindDecorator=__webpack_require__(66),_autobindDecorator2=_interopRequireDefault(_autobindDecorator),PlaybackSelector=(_class=function(_React$Component){function PlaybackSelector(props){_classCallCheck(this,PlaybackSelector);var _this=_possibleConstructorReturn(this,(PlaybackSelector.__proto__||Object.getPrototypeOf(PlaybackSelector)).call(this,props));return _this.state={mouseOver:""},_this}return _inherits(PlaybackSelector,_React$Component),_createClass(PlaybackSelector,[{key:"onMouseMove",value:function(e){this.setState(_extends({},this.state,{mouseOver:e.nativeEvent.target.className}))}},{key:"onMouseOut",value:function(e){this.setState(_extends({},this.state,{mouseOver:""}))}},{key:"render",value:function(){var _props=this.props,mode=_props.mode,onPlaybackChange=_props.onPlaybackChange,mouseOver=this.state.mouseOver,onMouseMove=this.onMouseMove,types=["fastBackward","backward","pause","forward","fastForward"],buttons=types.map(function(s,i){var className="playbackButton "+(s===mode?"active":"inactive"),src=function(){var url="/static/img/icon-"+s;return s!==mode&&mouseOver!==s||(url+="-hover"),url+".png"};return _react2.default.createElement("li",{className:className,key:i,onClick:function(){return onPlaybackChange(s)},onMouseMove:onMouseMove},_react2.default.createElement("img",{className:s,width:"16",height:"16",src:src()}))});return _react2.default.createElement("ul",{className:"playbackSelector buttonRow controlSelector",onMouseOut:this.onMouseOut},buttons)}}]),PlaybackSelector}(_react2.default.Component),_applyDecoratedDescriptor(_class.prototype,"onMouseMove",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseMove"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"onMouseOut",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseOut"),_class.prototype),_class);PlaybackSelector.propTypes={mode:_react.PropTypes.string.isRequired,onPlaybackChange:_react.PropTypes.func.isRequired},exports.default=PlaybackSelector},462:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),SharePage=function(){return _react2.default.createElement("div",{className:"page",id:"sharePage"},"Share page")};SharePage.propTypes={},exports.default=SharePage},463:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_d=__webpack_require__(87),d3=_interopRequireWildcard(_d),SightingGraph=function(_ref){var width=_ref.width,height=_ref.height,sightings=_ref.sightings,margin=.42;width-=margin*width;var x=d3.scaleLinear().domain([0,d3.max(sightings)]).range([width,width*margin]),y=d3.scaleLinear().domain([0,sightings.length-1]).range([height,0]);return _react2.default.createElement("g",null,_react2.default.createElement("path",{fill:"rgba(196,131,39,0.8)",d:d3.area().x0(width).x1(function(d){return x(d)}).y(function(d,i){return y(i)})(sightings)}))};SightingGraph.propTypes={width:_react.PropTypes.number.isRequired,height:_react.PropTypes.number.isRequired,sightings:_react.PropTypes.array},exports.default=SightingGraph},464:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};return Object.keys(descriptor).forEach(function(key){desc[key]=descriptor[key]}),desc.enumerable=!!desc.enumerable,desc.configurable=!!desc.configurable,("value"in desc||desc.initializer)&&(desc.writable=!0),desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc},desc),context&&void 0!==desc.initializer&&(desc.value=desc.initializer?desc.initializer.call(context):void 0,desc.initializer=void 0),void 0===desc.initializer&&(Object.defineProperty(target,property,desc),desc=null),desc}Object.defineProperty(exports,"__esModule",{value:!0});var _class,_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_d=__webpack_require__(87),d3=_interopRequireWildcard(_d),_autobindDecorator=__webpack_require__(66),_autobindDecorator2=_interopRequireDefault(_autobindDecorator),_SightingGraph=__webpack_require__(463),Timeline=(_interopRequireDefault(_SightingGraph),_class=function(_React$Component){function Timeline(props){_classCallCheck(this,Timeline);var _this=_possibleConstructorReturn(this,(Timeline.__proto__||Object.getPrototypeOf(Timeline)).call(this,props));return _this.state={padding:[2,8],x:0,cursorY:0,width:0,height:0,data:[],range:[0,0],domain:[0,0],scaleDays:null,scaleTime:null,totalSightings:[],mouseOver:!1},_this}return _inherits(Timeline,_React$Component),_createClass(Timeline,[{key:"componentWillReceiveProps",value:function(nextProps){var expedition=nextProps.expedition;if(expedition){for(var padding=this.state.padding,startDate=expedition.start,height=window.innerHeight-72,width=.05*window.innerWidth,x=.58*width,dayCount=expedition.dayCount+1,data=[],i=0;i<dayCount;i++){var d=new Date(startDate.getTime()+864e5*i);data.push(d)}var range=[0+padding[1],height-padding[1]],domain=[dayCount-1,0],scaleDays=d3.scaleLinear().domain(domain).range(range),scaleTime=d3.scaleLinear().domain([startDate.getTime()+864e5*(dayCount-1),startDate.getTime()]).range(range),cursorY=this.state.mouseOver?this.state.cursorY:scaleTime(expedition.currentDate.getTime())-8,totalSightings=expedition.totalSightings;this.setState(_extends({},this.state,{x:x,cursorY:cursorY,width:width,height:height,data:data,range:range,domain:domain,scaleDays:scaleDays,scaleTime:scaleTime,totalSightings:totalSightings}))}}},{key:"onClick",value:function(e){var _state=this.state,scaleTime=_state.scaleTime,range=_state.range,_props=this.props,jumpTo=_props.jumpTo,expeditionID=_props.expeditionID,y=e.nativeEvent.offsetY;jumpTo(new Date(scaleTime.invert(Math.max(range[0]+1,Math.min(range[1]-1,y)))),expeditionID)}},{key:"onMouseMove",value:function(e){var _state2=this.state,range=_state2.range,padding=_state2.padding,cursorY=Math.max(range[0],Math.min(range[1],e.nativeEvent.offsetY))-padding[1];this.setState(_extends({},this.state,{cursorY:cursorY,mouseOver:!0}))}},{key:"onMouseOut",value:function(e){var expedition=this.props.expedition,scaleTime=this.state.scaleTime,cursorY=scaleTime(expedition.currentDate.getTime())-8;this.setState(_extends({},this.state,{cursorY:cursorY,mouseOver:!1}))}},{key:"render",value:function(){var expedition=this.props.expedition;if(!expedition)return _react2.default.createElement("svg",{id:"timeline"});var _state3=this.state,height=(_state3.width,_state3.height),data=_state3.data,x=_state3.x,range=_state3.range,scaleDays=_state3.scaleDays,cursorY=_state3.cursorY,days=(_state3.totalSightings,_state3.padding,data.map(function(d,i){return _react2.default.createElement("circle",{cx:x,cy:scaleDays(i),r:3,key:i,fill:"white"})}));return _react2.default.createElement("svg",{id:"timeline",className:"/about"===location.pathname?"invisible":"visible",style:{height:height+"px"},onMouseOut:this.onMouseOut,onMouseMove:this.onMouseMove,onClick:this.onClick},_react2.default.createElement("filter",{id:"dropshadow",height:"120%"},_react2.default.createElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:"3"}),_react2.default.createElement("feOffset",{dx:"2",dy:"0",result:"offsetblur"}),_react2.default.createElement("feMerge",null,_react2.default.createElement("feMergeNode",null),_react2.default.createElement("feMergeNode",{in:"SourceGraphic"}))),_react2.default.createElement("line",{x1:x,x2:x,y1:range[0],y2:range[1],style:{stroke:"white"}}),_react2.default.createElement("g",null,days),_react2.default.createElement("g",{transform:"translate("+(x-20)+","+cursorY+")",style:{pointerEvents:"none"}},_react2.default.createElement("path",{fill:"#F9D144",d:"M8,0c5,0,12,8,12,8s-7,8-12,8c-4.4,0-8-3.6-8-8C0,3.6,3.6,0,8,0z",style:{filter:"url(#dropshadow)"}}),_react2.default.createElement("circle",{fill:"#1F1426",cx:"7.9",cy:"7.8",r:"3"})))}}]),Timeline}(_react2.default.Component),_applyDecoratedDescriptor(_class.prototype,"onClick",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onClick"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"onMouseMove",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseMove"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"onMouseOut",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseOut"),_class.prototype),_class);Timeline.propTypes={expedition:_react.PropTypes.object,jumpTo:_react.PropTypes.func.isRequired,expeditionID:_react.PropTypes.string},exports.default=Timeline},465:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};return Object.keys(descriptor).forEach(function(key){desc[key]=descriptor[key]}),desc.enumerable=!!desc.enumerable,desc.configurable=!!desc.configurable,("value"in desc||desc.initializer)&&(desc.writable=!0),desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc},desc),context&&void 0!==desc.initializer&&(desc.value=desc.initializer?desc.initializer.call(context):void 0,desc.initializer=void 0),void 0===desc.initializer&&(Object.defineProperty(target,property,desc),desc=null),desc}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _class,_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_viewportMercatorProject=__webpack_require__(270),_viewportMercatorProject2=_interopRequireDefault(_viewportMercatorProject),_three=__webpack_require__(2),THREE=_interopRequireWildcard(_three),_reactThreeRenderer=__webpack_require__(406),_reactThreeRenderer2=_interopRequireDefault(_reactThreeRenderer),_autobindDecorator=__webpack_require__(66),_autobindDecorator2=_interopRequireDefault(_autobindDecorator),WebGLOverlay=(_class=function(_Component){function WebGLOverlay(props){_classCallCheck(this,WebGLOverlay);var _this=_possibleConstructorReturn(this,(WebGLOverlay.__proto__||Object.getPrototypeOf(WebGLOverlay)).call(this,props)),paths={ambitGeo:[]},particles={members:[],sightings:{count:1e3,position:new THREE.BufferAttribute(new Float32Array(3e3),3),color:new THREE.BufferAttribute(new Float32Array(4e3),4),index:new THREE.BufferAttribute(new Uint16Array(1e3),1),data:[],vertexShader:["attribute vec4 color;","varying vec4 vColor;","void main() {","    vColor = color;","    vec4 mvPosition = modelViewMatrix * vec4( position.xy, 0.0 , 1.0 );","    gl_PointSize = float( position.z );","    gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["varying vec4 vColor;","uniform sampler2D texture;","vec4 vFragColor;","void main() {","    vFragColor = vColor * texture2D( texture, gl_PointCoord );","    if (vFragColor.w > 0.25) {","      gl_FragColor = vFragColor;","    } else {","      discard;","    }","}"].join("\n")},pictures360:{count:1e3,position:new THREE.BufferAttribute(new Float32Array(3e3),3),color:new THREE.BufferAttribute(new Float32Array(4e3),4),index:new THREE.BufferAttribute(new Uint16Array(1e3),1),data:[],vertexShader:["attribute vec4 color;","varying vec4 vColor;","void main() {","    vColor = color;","    vec4 mvPosition = modelViewMatrix * vec4( position.xy, 0.0 , 1.0 );","    gl_PointSize = 20.0;","    gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["varying vec4 vColor;","uniform sampler2D texture;","vec4 vFragColor;","void main() {","    vFragColor = vColor * texture2D( texture, gl_PointCoord );","    if (vFragColor.w > 0.35) {","      gl_FragColor = vFragColor;","    } else {","      discard;","    }","}"].join("\n")}};for(var k in particles)for(var i=0;i<particles[k].count;i++)particles[k].index.array[i]=i;return _this.state={paths:paths,particles:particles,render:function(){},sightingTexture:(new THREE.TextureLoader).load("static/img/sighting.png"),picture360Texture:(new THREE.TextureLoader).load("static/img/picture360.png"),mousePosition:[0,0],hoveredPicture:-1},_this}return _inherits(WebGLOverlay,_Component),_createClass(WebGLOverlay,[{key:"componentWillReceiveProps",value:function(nextProps){var _ViewportMercator=(0,_viewportMercatorProject2.default)(nextProps),unproject=_ViewportMercator.unproject,render=nextProps.redraw({unproject:unproject});if(!render)return void this.setState(_extends({},this.state,{particles:null}));var _render=render(this.state.particles,this.state.paths),particles=_render.particles,paths=_render.paths,hoveredPicture=-1;if(this.state.mousePosition[0]>0||this.state.mousePosition[1]>0)for(var positions=particles.pictures360.position.array,i=0;i<particles.pictures360.count;i++){var pos=[positions[3*i+0],positions[3*i+1]],dist=Math.sqrt(Math.pow(this.state.mousePosition[0]-pos[0],2)+Math.pow(this.state.mousePosition[1]-pos[1],2));if(dist<15){particles.pictures360.color.array[4*i+0]=1,particles.pictures360.color.array[4*i+1]=1,particles.pictures360.color.array[4*i+2]=1,particles.pictures360.color.array[4*i+3]=1,hoveredPicture=i,particles.pictures360.color.needsUpdate=!0;break}if(0===particles.pictures360.color.array[4*i+3])break}this.setState(_extends({},this.state,{particles:particles,paths:paths,render:render,hoveredPicture:hoveredPicture}))}},{key:"onMouseMove",value:function(event){this.setState(_extends({},this.state,{mousePosition:[event.pageX,event.pageY]}))}},{key:"onMouseOut",value:function(event){this.setState(_extends({},this.state,{mousePosition:[0,0]}))}},{key:"onClick",value:function(event){var show360Picture=this.props.show360Picture;this.state.hoveredPicture>-1&&show360Picture(this.state.particles.pictures360.data[this.state.hoveredPicture])}},{key:"render",value:function(){var _ViewportMercator2=(0,_viewportMercatorProject2.default)(this.props),project=_ViewportMercator2.project,_props=this.props,width=_props.width,height=_props.height,longitude=_props.longitude,latitude=_props.latitude,_state=this.state,particles=_state.particles,paths=_state.paths,point=project([longitude,latitude]),startPoint=project([this.state.longitude,this.state.latitude]),left=point[0]-startPoint[0],top=0-(point[1]-startPoint[1]),cameraProps={left:0,right:width,top:0,bottom:height,near:1,far:5e3,position:new THREE.Vector3(left,top,600),lookAt:new THREE.Vector3(left,top,0)},memberMarkers=particles.members.map(function(m,i){var x=Math.round(10*(m.position[0]-13.5))/10,y=Math.round(10*(m.position[1]-34))/10;return _react2.default.createElement("div",{key:m.name,className:"member-marker",style:{left:x,top:y}},_react2.default.createElement("img",{src:"static/img/member.svg",width:27,height:32}),_react2.default.createElement("span",null,m.name.charAt(0).toUpperCase()))}),sightingLabels=particles.sightings.data.map(function(p,i){var x=particles.sightings.position.array[3*i+0],y=particles.sightings.position.array[3*i+1];return x>=window.innerWidth/3&&x<2*window.innerWidth/3&&y>=window.innerHeight/3&&y<2*window.innerHeight/3?_react2.default.createElement("div",{key:i,className:"sighting-label",style:{left:x,top:y}},_react2.default.createElement("div",{className:"arrow-box"},p.count+" "+p.name)):null}),lines=paths.ambitGeo.map(function(p,i){return _react2.default.createElement("line",{key:i},_react2.default.createElement("geometry",{vertices:p.vertices,dynamic:!0}),_react2.default.createElement("lineBasicMaterial",{linewidth:2,opacity:.7,transparent:!0,color:p.color}))});return _react2.default.createElement("div",null,_react2.default.createElement("div",{className:"hitbox"+(this.state.hoveredPicture>-1?" hover":""),onMouseMove:this.onMouseMove,onMouseOut:this.onMouseOut,onClick:this.onClick}),_react2.default.createElement("div",{id:"html-renderer",style:{position:"absolute",width:"100%",height:"100%"}},sightingLabels,memberMarkers),_react2.default.createElement("div",{id:"three-renderer"},_react2.default.createElement(_reactThreeRenderer2.default,{mainCamera:"camera",width:width,height:height,onAnimate:this._onAnimate,alpha:!0,antialias:!0},_react2.default.createElement("scene",null,_react2.default.createElement("orthographicCamera",_extends({name:"camera"},cameraProps)),lines,particles&&_react2.default.createElement("points",null,_react2.default.createElement("bufferGeometry",{position:particles.sightings.position,index:particles.sightings.index,color:particles.sightings.color}),_react2.default.createElement("shaderMaterial",{vertexShader:particles.sightings.vertexShader,fragmentShader:particles.sightings.fragmentShader,uniforms:{texture:{type:"t",value:this.state.sightingTexture}}})),particles&&_react2.default.createElement("points",null,_react2.default.createElement("bufferGeometry",{position:particles.pictures360.position,index:particles.pictures360.index,color:particles.pictures360.color}),_react2.default.createElement("shaderMaterial",{vertexShader:particles.pictures360.vertexShader,fragmentShader:particles.pictures360.fragmentShader,uniforms:{texture:{type:"t",value:this.state.picture360Texture}}}))))))}}]),WebGLOverlay}(_react.Component),_applyDecoratedDescriptor(_class.prototype,"onMouseMove",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseMove"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"onMouseOut",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onMouseOut"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"onClick",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"onClick"),_class.prototype),_class);exports.default=WebGLOverlay,WebGLOverlay.propTypes={show360Picture:_react.PropTypes.func.isRequired,currentDate:_react.PropTypes.object,width:_react.PropTypes.number.isRequired,height:_react.PropTypes.number.isRequired,latitude:_react.PropTypes.number.isRequired,longitude:_react.PropTypes.number.isRequired,zoom:_react.PropTypes.number.isRequired,redraw:_react.PropTypes.func.isRequired,isDragging:_react.PropTypes.bool.isRequired}},466:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),YearSelector=function(_ref){var expeditionID=_ref.expeditionID,expeditions=_ref.expeditions,onYearChange=_ref.onYearChange,toggleDropdown=function(){document.getElementById("YearSelectorDropdown").classList.toggle("show")},currentExpeditionName=expeditions[expeditionID].name,expeditionList=Object.keys(expeditions).sort(function(a,b){
return expeditions[b].end.getTime()-expeditions[a].end.getTime()}).map(function(k,i){var expedition=expeditions[k];return _react2.default.createElement("a",{href:"#",onClick:function(){return onYearChange(k)},key:i},expedition.name)});return _react2.default.createElement("div",{className:"dropdown yearSelector controlSelector"},_react2.default.createElement("button",{onClick:toggleDropdown,className:"dropbtn"},currentExpeditionName,_react2.default.createElement("span",null)),_react2.default.createElement("div",{id:"YearSelectorDropdown",className:"dropdown-content"},expeditionList))};YearSelector.propTypes={onYearChange:_react.PropTypes.func.isRequired,expeditionID:_react.PropTypes.string.isRequired,expeditions:_react.PropTypes.object.isRequired},exports.default=YearSelector},467:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_viewportMercatorProject=__webpack_require__(270),_viewportMercatorProject2=_interopRequireDefault(_viewportMercatorProject),_autobindDecorator=__webpack_require__(66),ZoomSelector=(_interopRequireDefault(_autobindDecorator),function(_React$Component){function ZoomSelector(props){_classCallCheck(this,ZoomSelector);var _this=_possibleConstructorReturn(this,(ZoomSelector.__proto__||Object.getPrototypeOf(ZoomSelector)).call(this,props));return _this.state={mouseOver:""},_this}return _inherits(ZoomSelector,_React$Component),_createClass(ZoomSelector,[{key:"render",value:function(){var _props=this.props,onZoomChange=_props.onZoomChange,viewport=_props.viewport,mouseOver=(this.onMouseMove,this.state.mouseOver),types=["decrement","increment"],buttons=types.map(function(s,i){var src=function(){var url="/static/img/icon-"+s;return mouseOver===s&&(url+="-hover"),url+".png"};return _react2.default.createElement("li",{className:"zoomButton",key:i,onClick:function(){onZoomChange(s)}},_react2.default.createElement("img",{className:s,width:"16",height:"16",src:src()}))}),_ViewportMercator=(0,_viewportMercatorProject2.default)(_extends({},viewport)),unproject=_ViewportMercator.unproject,scaleRange=111*(unproject([64,0])[0]-unproject([0,0])[0]),scaleString=Math.round(scaleRange)+"km";return scaleRange<1&&(scaleString=Math.round(1e3*scaleRange)+"m"),_react2.default.createElement("div",{className:"selector controlSelector"},_react2.default.createElement("div",{className:"column"},_react2.default.createElement("ul",{className:"buttonRow"},buttons)),_react2.default.createElement("svg",{className:"column"},_react2.default.createElement("line",{x1:0,y1:17.5,x2:12,y2:17.5,stroke:"white"}),_react2.default.createElement("line",{x1:52,y1:17.5,x2:64,y2:17.5,stroke:"white"}),_react2.default.createElement("line",{x1:.5,y1:12,x2:.5,y2:22,stroke:"white"}),_react2.default.createElement("line",{x1:63.5,y1:12,x2:63.5,y2:22,stroke:"white"}),_react2.default.createElement("text",{x:32,y:18,fill:"white",style:{fontSize:"12px",alignmentBaseline:"middle",textAnchor:"middle"}},scaleString)))}}]),ZoomSelector}(_react2.default.Component));ZoomSelector.propTypes={onZoomChange:_react.PropTypes.func.isRequired,viewPort:_react.PropTypes.object},exports.default=ZoomSelector},468:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _reactRedux=__webpack_require__(131),_JournalPage=__webpack_require__(452),_JournalPage2=_interopRequireDefault(_JournalPage),_actions=__webpack_require__(116),actions=_interopRequireWildcard(_actions),_d=__webpack_require__(87),d3=_interopRequireWildcard(_d),_utils=__webpack_require__(67),mapStateToProps=function(state,ownProps){var expeditionID=state.selectedExpedition,expedition=state.expeditions[expeditionID];return expedition?{expedition:expedition,posts:d3.values(expedition.features).map(function(p){var title,content,images,link,dimensions,key=p.id,type=p.properties.FeatureType,date=(0,_utils.parseDate)(p.properties.DateTime),location=p.geometry.coordinates,author=p.properties.Member;return"tweet"===type&&("okavango_14"!==expeditionID?(content=p.properties.Text,images=p.properties.Images.map(function(i){return i.Url.replace("http://","https://")}),link=p.properties.Url.replace("http://","https://")):content=p.properties.Tweet.text),"image"===type&&("RICOH"===p.properties.Make?type="360Image":"okavango_14"!==expeditionID?(content=p.properties.Notes,images=[p.properties.Url.replace("http://","https://")],link=p.properties.InstagramID,dimensions=p.properties.Dimensions):(content=p.properties.Notes,images=[p.properties.Url.replace("http://","https://")],link=p.properties.InstagramID,dimensions=p.properties.Size)),"blog"===type&&(title=p.properties.Title,content=p.properties.Summary,link=p.properties.Url.replace("http://","https://")),"audio"===type&&(title=p.properties.Title,link=p.properties.SoundCloudURL.replace("http://","https://")),{key:key,type:type,title:title,content:content,images:images,link:link,date:date,location:location,author:author,dimensions:dimensions}})}:{posts:[]}},mapDispatchToProps=function(dispatch,ownProps){return{checkFeedContent:function(){return dispatch(actions.checkFeedContent())}}},JournalPageContainer=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(_JournalPage2.default);exports.default=JournalPageContainer},469:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _reactRedux=__webpack_require__(131),_NotificationPanel=__webpack_require__(459),_NotificationPanel2=_interopRequireDefault(_NotificationPanel),mapStateToProps=function(state,ownProps){var expedition=state.expeditions[state.selectedExpedition];return expedition?{posts:expedition.currentPosts,currentDate:expedition.currentDate,playback:expedition.playback}:{}},mapDispatchToProps=function(dispatch,ownProps){return{}},NotificationPanelContainer=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(_NotificationPanel2.default);exports.default=NotificationPanelContainer},470:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _reactRedux=__webpack_require__(131),_Okavango=__webpack_require__(460),_Okavango2=_interopRequireDefault(_Okavango),_actions=__webpack_require__(116),actions=_interopRequireWildcard(_actions),_utils=__webpack_require__(67),mapStateToProps=function(state,ownProps){return{expedition:state.expeditions[state.selectedExpedition],children:ownProps.children,animate:state.animate,isFetching:state.isFetching,mapStateNeedsUpdate:state.mapStateNeedsUpdate,expeditionID:state.selectedExpedition,contentActive:state.contentActive,lightBoxActive:state.lightBoxActive,lightBoxPost:state.lightBoxPost?formatPost(state.lightBoxPost,state.selectedExpedition):null}},formatPost=function(p,expeditionID){var title,content,images,link,dimensions,next,previous,key=p.id,type=p.properties.FeatureType,date=(0,_utils.parseDate)(p.properties.DateTime),location=p.geometry.coordinates,author=p.properties.Member;return"tweet"===type&&("okavango_14"!==expeditionID?(content=p.properties.Text,images=p.properties.Images.map(function(i){return i.Url.replace("http://","https://")}),link=p.properties.Url.replace("http://","https://")):content=p.properties.Tweet.text),"image"===type&&("okavango_14"!==expeditionID?(content=p.properties.Notes,images=[p.properties.Url.replace("http://","https://")],link=p.properties.InstagramID,dimensions=p.properties.Dimensions):(content=p.properties.Notes,images=[p.properties.Url.replace("http://","https://")],link=p.properties.InstagramID,dimensions=p.properties.Size),"RICOH"===p.properties.Make&&(type="360Image",next=p.properties.next,previous=p.properties.previous)),"blog"===type&&(title=p.properties.Title,content=p.properties.Summary,link=p.properties.Url.replace("http://","https://")),"audio"===type&&(title=p.properties.Title,link=p.properties.SoundCloudURL.replace("http://","https://")),{key:key,type:type,title:title,content:content,images:images,link:link,date:date,location:location,author:author,dimensions:dimensions,next:next,previous:previous}},mapDispatchToProps=function(dispatch,ownProps){return{fetchDay:function(currentDate){return dispatch(actions.fetchDay(currentDate))},updateMap:function(currentDate,coordinates,viewGeoBounds,zoom,expeditionID){return dispatch(actions.updateMap(currentDate,coordinates,viewGeoBounds,zoom,expeditionID))},setControl:function(target,mode){return dispatch(actions.setControl(target,mode))},jumpTo:function(date,expeditionID){return dispatch(actions.jumpTo(date,expeditionID))},setPage:function(){return dispatch(actions.setPage())},enableContent:function(){return dispatch(actions.enableContent())},show360Picture:function(post){return dispatch(actions.show360Picture(post))},closeLightBox:function(){return dispatch(actions.closeLightBox())}}},OkavangoContainer=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(_Okavango2.default);exports.default=OkavangoContainer},471:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(473);var _react=__webpack_require__(5),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(242),_reactDom2=_interopRequireDefault(_reactDom),_redux=__webpack_require__(435),_reactRedux=__webpack_require__(131),_reduxThunk=__webpack_require__(1067),_reduxThunk2=_interopRequireDefault(_reduxThunk),_actions=__webpack_require__(116),_reducers=__webpack_require__(472),_reducers2=_interopRequireDefault(_reducers),_reactRouter=__webpack_require__(402),_OkavangoContainer=__webpack_require__(470),_OkavangoContainer2=_interopRequireDefault(_OkavangoContainer),_MapPage=__webpack_require__(455),_MapPage2=_interopRequireDefault(_MapPage),_JournalPageContainer=__webpack_require__(468),_JournalPageContainer2=_interopRequireDefault(_JournalPageContainer),_DataPage=__webpack_require__(446),_AboutPage=(_interopRequireDefault(_DataPage),__webpack_require__(443)),_AboutPage2=_interopRequireDefault(_AboutPage),_SharePage=__webpack_require__(462),_SharePage2=_interopRequireDefault(_SharePage);document.getElementById("root").remove();var store=(0,_redux.createStore)(_reducers2.default,(0,_redux.applyMiddleware)(_reduxThunk2.default)),routes=_react2.default.createElement(_reactRouter.Route,{path:"/",component:_OkavangoContainer2.default},_react2.default.createElement(_reactRouter.IndexRoute,{component:_MapPage2.default}),_react2.default.createElement(_reactRouter.Route,{path:"map",component:_MapPage2.default}),_react2.default.createElement(_reactRouter.Route,{path:"journal",component:_JournalPageContainer2.default}),_react2.default.createElement(_reactRouter.Route,{path:"about",component:_AboutPage2.default}),_react2.default.createElement(_reactRouter.Route,{path:"share",component:_SharePage2.default})),render=function(){_reactDom2.default.render(_react2.default.createElement(_reactRedux.Provider,{store:store},_react2.default.createElement(_reactRouter.Router,{history:_reactRouter.browserHistory,routes:routes})),document.getElementById("okavango"))};store.subscribe(render),store.dispatch((0,_actions.fetchExpeditions)()),window.onclick=function(event){if(!event.target.matches(".dropbtn")){var i,dropdowns=document.getElementsByClassName("dropdown-content");for(i=0;i<dropdowns.length;i++){var openDropdown=dropdowns[i];openDropdown.classList.contains("show")&&openDropdown.classList.remove("show")}}}},472:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_actions=__webpack_require__(116),actions=_interopRequireWildcard(_actions),_d=__webpack_require__(87),d3=_interopRequireWildcard(_d),_randomcolor=__webpack_require__(856),_randomcolor2=_interopRequireDefault(_randomcolor),_utils=__webpack_require__(67),MIN_ZOOM=14,okavangoReducer=function(){var expeditions,features,id,expeditionID,expedition,days,state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isInitialLoad:!0,mapStateNeedsUpdate:!1,animate:!1,isFetching:!0,selectedExpedition:null,expeditions:{},speciesColors:{},contentActive:"/map"!==location.pathname,lightBoxActive:!1,lightBoxID:""},action=arguments[1];switch(action.type){case actions.CLOSE_LIGHTBOX:return _extends({},state,{lightBoxActive:!1,lightBoxID:""});case actions.SHOW_360_PICTURE:return _extends({},state,{lightBoxActive:!0,lightBoxPost:action.post});case actions.HIDE_360_PICTURE:return _extends({},state,{lightBoxActive:!1,lightBoxID:""});case actions.SET_PAGE:return _extends({},state,{lightBoxActive:!1});case actions.ENABLE_CONTENT:return _extends({},state,{contentActive:!0});case actions.RECEIVE_POSTS:expeditionID=action.expeditionID,expedition=state.expeditions[expeditionID];var timeRange=action.timeRange,postsByDay={},start=new Date(timeRange[0]),end=new Date(timeRange[1]),startDay=Math.floor((start.getTime()-expedition.start.getTime())/864e5),endDay=Math.floor((end.getTime()-expedition.start.getTime())/864e5);for(i=startDay;i<=endDay;i++)postsByDay[i]={};return features={},action.data.forEach(function(f){var id=f.id,flag=!0;f.geometry||(flag=!1),"image"===f.properties.FeatureType&&"RICOH"===f.properties.Make&&(flag=!1),flag&&(features[id]=featureReducer(expedition.features[id],action,f))}),Object.keys(features).forEach(function(id){var feature=features[id],day=Math.floor(((0,_utils.parseDate)(feature.properties.DateTime).getTime()-expedition.start.getTime())/864e5);postsByDay[day]||(postsByDay[day]={}),postsByDay[day][id]=feature}),Object.keys(postsByDay).forEach(function(k){postsByDay[k]=Object.assign({},expedition.postsByDay[k],postsByDay[k])}),Object.assign({},state,{mapStateNeedsUpdate:!1,expeditions:Object.assign({},state.expeditions,_defineProperty({},expeditionID,Object.assign({},expedition,{features:Object.assign({},expedition.features,features),postsByDay:Object.assign({},expedition.postsByDay,postsByDay)})))});case actions.FETCH_POSTS_BY_DAY:return id=action.expeditionID,Object.assign({},state,{expeditions:Object.assign({},state.expeditions,_defineProperty({},id,expeditionReducer(state.expeditions[id],action)))});case actions.RECEIVE_TOTAL_SIGHTINGS:return id=action.id,Object.assign({},state,{expeditions:Object.assign({},state.expeditions,_defineProperty({},id,Object.assign({},state.expeditions[action.id],{totalSightings:action.data.results})))});case actions.COMPLETE_DAYS:return id=action.expeditionID,Object.assign({},state,{mapStateNeedsUpdate:!1,expeditions:Object.assign({},state.expeditions,_defineProperty({},id,expeditionReducer(state.expeditions[id],action)))});case actions.SHOW_LOADING_WHEEL:return Object.assign({},state,{mapStateNeedsUpdate:!1,isFetching:!0});case actions.HIDE_LOADING_WHEEL:return Object.assign({},state,{mapStateNeedsUpdate:!0,isFetching:!1});case actions.START:return Object.assign({},state,{mapStateNeedsUpdate:!0,isInitialLoad:!1,animate:!0});case actions.UPDATE_TIME:return expeditionID=action.expeditionID,Object.assign({},state,{mapStateNeedsUpdate:action.updateMapState,expeditions:Object.assign({},state.expeditions,_defineProperty({},expeditionID,expeditionReducer(state.expeditions[expeditionID],action)))});case actions.UPDATE_MAP:return expeditionID=action.expeditionID,Object.assign({},state,{mapStateNeedsUpdate:!0,expeditions:Object.assign({},state.expeditions,_defineProperty({},expeditionID,expeditionReducer(state.expeditions[expeditionID],action)))});case actions.RECEIVE_EXPEDITIONS:expeditions={};var latestExpedition,latestDate=new Date(0);return Object.keys(action.data.results).forEach(function(id){action.data.results[id]=_extends({},action.data.results[id],{Days:14})}),Object.keys(action.data.results).forEach(function(id){var e=action.data.results[id];expeditions[id]=expeditionReducer(state.expeditions[id],action,e),expeditions[id].start.getTime()+864e5*expeditions[id].dayCount>latestDate.getTime()&&(latestDate=new Date(expeditions[id].start.getTime()+864e5*expeditions[id].dayCount),latestExpedition="cuando_18")}),Object.assign({},state,{expeditions:Object.assign({},state.expeditions,expeditions),isFetching:!1,selectedExpedition:latestExpedition});case actions.SET_EXPEDITION:var selectedExpedition=action.id;return Object.assign({},state,{mapStateNeedsUpdate:!0,selectedExpedition:selectedExpedition});case actions.SET_CONTROL:return id=state.selectedExpedition,expeditions=_defineProperty({},id,expeditionReducer(state.expeditions[id],action)),Object.assign({},state,{mapStateNeedsUpdate:"zoom"===action.target,expeditions:Object.assign({},state.expeditions,expeditions)});case actions.RECEIVE_DAY:expeditionID=action.expeditionID,expedition=state.expeditions[expeditionID];for(var members=_extends({},expedition.members),featuresByMember={},featuresByDay={},ambitsByTile={},dateRange=action.dateRange.map(function(d){return Math.floor((new Date(d).getTime()-expedition.start.getTime())/864e5)}),i=dateRange[0];i<=dateRange[1];i++)featuresByDay[i]={};features={},action.data.forEach(function(f){var id=f.id;("ambit_geo"===f.properties.FeatureType&&"RiverMain"===f.properties.Team||"beacon"===f.properties.FeatureType&&("WBT Primary"===f.properties.Satellite||"WBT Secondary"===f.properties.Satellite))&&("ambit_geo"===f.properties.FeatureType&&"Steve"!==f.properties.Member&&"Water"!==f.properties.Member&&"Kerllen"!==f.properties.Member&&"Chris"!==f.properties.Member||(features[id]=featureReducer(expedition.features[id],action,f),"ambit_geo"===f.properties.FeatureType&&(members[f.properties.Member]||(members[f.properties.Member]={color:expedition.memberColors[d3.values(members).length%expedition.memberColors.length]}))))});var tileResolution=Math.floor(111*(expedition.geoBounds[2]-expedition.geoBounds[0])/10),coordinatesToTile=function(coordinates,geoBounds){var x=Math.floor(111*(coordinates[0]-geoBounds[0])/10),y=Math.floor(111*(coordinates[1]-geoBounds[3])/10);return{x:x,y:y}};Object.keys(features).forEach(function(id){var feature=features[id],day=Math.floor(((0,_utils.parseDate)(feature.properties.DateTime).getTime()-expedition.start.getTime())/864e5),type=feature.properties.FeatureType;if(featuresByDay[day]||(featuresByDay[day]={}),featuresByDay[day][type]||(featuresByDay[day][type]={}),featuresByDay[day][type][id]=feature,"ambit_geo"===feature.properties.FeatureType){var memberID=feature.properties.Member;members[memberID]||(members[memberID]={name:memberID,color:expedition.memberColors[d3.values(members).length%expedition.memberColors.length]});var dayID=Math.floor(((0,_utils.parseDate)(feature.properties.DateTime).getTime()-expedition.start.getTime())/864e5);featuresByMember[memberID]||(featuresByMember[memberID]={}),featuresByMember[memberID][dayID]||(featuresByMember[memberID][dayID]={}),featuresByMember[memberID][dayID][id]=feature;var tileCoordinates=coordinatesToTile(feature.geometry.coordinates,expedition.geoBounds),tileID=tileCoordinates.x+tileCoordinates.y*tileResolution;ambitsByTile[tileID]||(ambitsByTile[tileID]={}),ambitsByTile[tileID][id]=feature}});var extendFeatures=function(bucket){if(d3.values(bucket).length>0){var timeRange=[new Date,new Date(0)],featureRange=[];d3.values(bucket).forEach(function(f){var dateTime=(0,_utils.parseDate)(f.properties.DateTime);timeRange[0].getTime()>dateTime.getTime()&&(timeRange[0]=dateTime,featureRange[0]=f),timeRange[1].getTime()<dateTime.getTime()&&(timeRange[1]=dateTime,featureRange[1]=f)});var start=new Date(timeRange[0].getTime()-timeRange[0].getTime()%864e5),end=new Date(start.getTime()+864e5);id=Date.now()+Math.floor(1e4*Math.random())/1e4,bucket[id]=Object.assign({},featureRange[0]),bucket[id].properties=Object.assign({},bucket[id].properties,{DateTime:start.toString()}),id=Date.now()+Math.floor(1e4*Math.random())/1e4,bucket[id]=Object.assign({},featureRange[1]),bucket[id].properties=Object.assign({},bucket[id].properties,{DateTime:end.toString()})}};Object.keys(featuresByDay).forEach(function(d){featuresByDay[d]=Object.assign({},expedition.featuresByDay[d],featuresByDay[d]),extendFeatures(featuresByDay[d].beacon)}),Object.keys(featuresByMember).forEach(function(m){Object.keys(featuresByMember[m]).forEach(function(d){extendFeatures(featuresByMember[m][d])})}),featuresByDay=Object.assign({},expedition.featuresByDay,featuresByDay),days=Object.assign({},featuresByDay);for(var d in days)days[d]=dayReducer(expedition.days[d],action,featuresByDay[d]);return Object.keys(featuresByMember).forEach(function(k){featuresByMember[k]=Object.assign({},expedition.featuresByMember[k],featuresByMember[k])}),Object.keys(ambitsByTile).forEach(function(k){ambitsByTile[k]=Object.assign({},expedition.ambitsByTile[k],ambitsByTile[k])}),Object.assign({},state,{mapStateNeedsUpdate:!1,expeditions:Object.assign({},state.expeditions,_defineProperty({},expeditionID,Object.assign({},expedition,{days:Object.assign({},expedition.days,days),featuresByDay:featuresByDay,featuresByMember:Object.assign({},expedition.featuresByMember,featuresByMember),ambitsByTile:Object.assign({},expedition.ambitsByTile,ambitsByTile),members:members})))});case actions.RECEIVE_FEATURES:expeditionID=action.expeditionID,expedition=state.expeditions[expeditionID];var tileRange=action.tileRange,featuresByTile={};tileRange.forEach(function(t,i){featuresByTile[t]={}}),features={},action.data.forEach(function(f){var id=f.id;if("RiverMain"===f.properties.Team){var flag=!0;if("sighting"===f.properties.FeatureType)if(f.properties.Taxonomy){var taxClass=f.properties.Taxonomy.Class;state.speciesColors[taxClass]||(state.speciesColors[taxClass]=parseInt((0,_randomcolor2.default)({luminosity:"light",format:"hex"}).slice(1),16)),f.properties.color=state.speciesColors[taxClass]}else f.properties.color=11842740;"tweet"===f.properties.FeatureType&&f.properties.Text&&"@"===f.properties.Text[0]&&(flag=!1),flag&&(features[id]=featureReducer(expedition.features[id],action,f))}});var tileResolution=Math.floor(111*(expedition.geoBounds[2]-expedition.geoBounds[0])/10),coordinatesToTile=function(coordinates,geoBounds){var x=Math.floor(111*(coordinates[0]-geoBounds[0])/10),y=Math.floor(111*(coordinates[1]-geoBounds[3])/10);return{x:x,y:y}};Object.keys(features).forEach(function(id){var feature=features[id],tileCoordinates=coordinatesToTile(feature.geometry.coordinates,expedition.geoBounds),tileID=tileCoordinates.x+tileCoordinates.y*tileResolution;featuresByTile[tileID]||(featuresByTile[tileID]={}),featuresByTile[tileID][id]=feature}),Object.keys(featuresByTile).forEach(function(k){featuresByTile[k]=Object.assign({},expedition.featuresByTile[k],featuresByTile[k])});for(var k in features){var feature=features[k];"sighting"===feature.properties.FeatureType&&delete features[k]}return Object.assign({},state,{mapStateNeedsUpdate:!1,expeditions:Object.assign({},state.expeditions,_defineProperty({},expeditionID,Object.assign({},expedition,{features:Object.assign({},expedition.features,features),featuresByTile:Object.assign({},expedition.featuresByTile,featuresByTile)})))});case actions.SELECT_FEATURE:break;case actions.UNSELECT_FEATURE:break;default:return state}return state},expeditionReducer=function(){var i,state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"",playback:"forward",layout:"rows",initialZoom:4,targetZoom:MIN_ZOOM,zoom:MIN_ZOOM,isFetching:!1,geoBounds:[-8,-21.5,25.5,12],tileSize:10,start:new Date,end:new Date(0),currentDate:new Date,dayCount:0,days:[],features:{},featuresByTile:{},ambitsByTile:{},featuresByDay:{},postsByDay:{},featuresByMember:{},mainFocus:"Explorers",secondaryFocus:"Chris",coordinates:[0,0],current360Images:[],currentGeoBounds:[0,0],currentPosts:[],currentSightings:[],currentAmbits:[],totalSightings:[],members:{},currentMembers:[],memberColors:[16629615,10931939,11722634,16489113,13284054,16575127,11858129,12566527,16755669]},action=arguments[1],data=arguments[2];switch(action.type){case actions.FETCH_POSTS_BY_DAY:var postsByDay=[];return action.daysToFetch.forEach(function(d){postsByDay[d]="loading"}),Object.assign({},state,{postsByDay:Object.assign({},state.postsByDay,postsByDay)});case actions.COMPLETE_DAYS:var days=Object.assign({},state.days);for(i=0;i<state.dayCount;i++)if(days[i]&&!days[i].incomplete){days[-1]=Object.assign({},days[i]);break}for(i=state.dayCount;i>=0;i--)if(days[i]&&!days[i].incomplete){days[state.dayCount]=Object.assign({},days[i]);break}var incompleteRange=[-1,-1],completedDays=[];for(i=0;i<state.dayCount;i++){var day=days[i];if(day?(day.incomplete&&days[i-1]&&!days[i-1].incomplete&&(incompleteRange[0]=i,incompleteRange[1]=-1),day.incomplete&&days[i+1]&&!days[i+1].incomplete&&(incompleteRange[1]=i)):incompleteRange=[-1,-1],incompleteRange[0]>-1&&incompleteRange[1]>-1){for(var fillingDays=[days[+incompleteRange[0]-1],days[+incompleteRange[1]+1]],fillingBeacons=[d3.values(fillingDays[0].beacons).slice(0).sort(function(a,b){return(0,_utils.parseDate)(b.properties.DateTime).getTime()-(0,_utils.parseDate)(a.properties.DateTime).getTime()})[0],d3.values(fillingDays[1].beacons).slice(0).sort(function(a,b){return(0,_utils.parseDate)(a.properties.DateTime).getTime()-(0,_utils.parseDate)(b.properties.DateTime).getTime()})[0]],l2=Math.ceil((incompleteRange[1]-incompleteRange[0]+1)/2),j=0;j<l2;j++)for(var dayIndex=[+incompleteRange[0]+j,+incompleteRange[1]-j],k=0;k<2;k++)for(var l=0;l<2;l++)if(0===k||days[dayIndex[0]]!==days[dayIndex[1]]||0===l){var dayID=dayIndex[k];day=days[dayID];var date=new Date(state.start.getTime()+864e5*(dayID+(k===l?0:1))),beaconID=Date.now()+Math.floor(1e4*Math.random())/1e4;day.beacons[beaconID]=Object.assign({},fillingBeacons[k]),day.beacons[beaconID].properties=Object.assign({},day.beacons[beaconID].properties,{DateTime:date}),day.incomplete=!1,completedDays.indexOf(dayID)===-1&&completedDays.push(dayID)}incompleteRange=[-1,-1]}}delete days[-1],delete days[state.dayCount];var sortedDays={};return Object.keys(days).forEach(function(dayId){var sortedBeacons=d3.values(days[dayId].beacons).sort(function(a,b){return(0,_utils.parseDate)(b.properties.DateTime).getTime()-(0,_utils.parseDate)(a.properties.DateTime).getTime()});sortedDays[dayId]=Object.assign({},days[dayId],{sortedBeacons:sortedBeacons})}),Object.assign({},state,{days:sortedDays});case actions.UPDATE_TIME:return Object.assign({},state,{currentDate:action.currentDate});case actions.UPDATE_MAP:action.tileRange.forEach(function(t){state.featuresByTile[t]||(state.featuresByTile[t]={})});var currentSightings=[],current360Images=[],currentPosts=[],currentDays=[],currentAmbits={},currentMembers=[],allAmbits=[];action.tilesInView.forEach(function(t){var features={};if(d3.values(state.featuresByTile[t]).forEach(function(f){features[f.properties.FeatureType]||(features[f.properties.FeatureType]=[]),features[f.properties.FeatureType].push(f);var day=Math.floor(((0,_utils.parseDate)(f.properties.DateTime).getTime()-state.start.getTime())/864e5);currentDays.indexOf(day)===-1&&currentDays.push(day)}),d3.values(state.ambitsByTile[t]).forEach(function(f){var day=Math.floor(((0,_utils.parseDate)(f.properties.DateTime).getTime()-state.start.getTime())/864e5);currentDays.indexOf(day)===-1&&currentDays.push(day)}),features.sighting){var sightings=features.sighting.map(function(f){return{position:{x:f.geometry.coordinates[0],y:f.geometry.coordinates[1],z:0},radius:f.properties.radius,color:f.properties.color,type:f.properties.FeatureType,date:(0,_utils.parseDate)(f.properties.DateTime),name:f.properties.SpeciesName,count:f.properties.Count}});currentSightings=currentSightings.concat(sightings)}if(features.image){var images=features.image.filter(function(i){return"RICOH"===i.properties.Make});current360Images=current360Images.concat(images)}current360Images.forEach(function(image,i){image.properties.next=current360Images[i-1],image.properties.previous=current360Images[i+1]});var allPosts=[];if(features.tweet&&(allPosts=allPosts.concat(features.tweet)),features.audio&&(allPosts=allPosts.concat(features.audio)),features.blog&&(allPosts=allPosts.concat(features.blog)),features.image&&(allPosts=allPosts.concat(features.image)),allPosts){var posts=allPosts.map(function(f){return{position:[f.geometry.coordinates[0],f.geometry.coordinates[1]],type:f.properties.FeatureType,id:f.id,properties:f.properties}});currentPosts=currentPosts.concat(posts)}});var paddingDays=[];return currentDays.forEach(function(d){var flag=!1;for(i=d-1;i<=d+1;i++)currentDays.indexOf(i)===-1&&paddingDays.indexOf(i)===-1&&(paddingDays.push(i),flag=!0);flag&&actions.fetchDay(new Date(state.start.getTime()+864e5*d))}),currentDays=currentDays.concat(paddingDays),currentDays=currentDays.sort(function(a,b){return a-b}).forEach(function(d){state.featuresByDay[d]&&(allAmbits=allAmbits.concat(d3.values(state.featuresByDay[d].ambit_geo)))}),allAmbits.forEach(function(f){var name=f.properties.Member;currentAmbits[name]||(currentAmbits[name]={color:state.members[name].color,coordinates:[],dates:[]}),currentMembers[name]||(currentMembers[name]={}),currentAmbits[name].coordinates.push(f.geometry.coordinates),currentAmbits[name].dates.push(f.properties.DateTime);
}),currentAmbits=d3.values(currentAmbits),Object.assign({},state,{coordinates:action.coordinates,currentAmbits:currentAmbits,currentDate:action.currentDate,currentGeoBounds:action.viewGeoBounds,currentMembers:currentMembers,currentPosts:currentPosts,currentSightings:currentSightings,current360Images:current360Images,zoom:action.zoom});case actions.RECEIVE_EXPEDITIONS:var dayCount=data.Days,start=new Date((0,_utils.parseDate)(data.StartDate).getTime()+72e5),end=new Date(start.getTime()+864e5*dayCount),currentDate=new Date(end.getTime()-1728e5),name=data.Name,geoBounds=data.GeoBounds;return Object.assign({},state,{name:name,start:start,currentDate:currentDate,end:end,dayCount:dayCount,geoBounds:geoBounds});case actions.SET_CONTROL:return"zoom"===action.target&&("increment"===action.mode&&(action.mode=Math.max(1,Math.min(MIN_ZOOM,state.zoom+1))),"decrement"===action.mode&&(action.mode=Math.max(1,Math.min(MIN_ZOOM,state.zoom-1)))),Object.assign({},state,_defineProperty({},action.target,action.mode))}return state},dayReducer=function(){var start,end,state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,start:new Date,end:new Date(0),beacons:{},ambits:{},incomplete:!0},action=arguments[1],features=arguments[2];switch(action.type){case actions.RECEIVE_DAY:if(start=new Date,end=new Date(0),!features.beacon)break;var incomplete=0===Object.keys(features.beacon).length;return Object.keys(features.beacon).forEach(function(k){var f=features.beacon[k],d=(0,_utils.parseDate)(f.properties.DateTime);d.getTime()<start.getTime()&&(start=d),d.getTime()>end.getTime()&&(end=d)}),Object.assign({},state,{isFetching:!1,start:start,end:end,beacons:Object.assign({},state.beacons,features.beacon),ambits:Object.assign({},state.ambits,features.ambit),incomplete:incomplete})}return state},featureReducer=function(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},action=arguments[1],feature=arguments[2];switch(action.type){case actions.RECEIVE_POSTS:return feature.properties.scatter=[75e-5*(2*Math.random()-1),75e-5*(2*Math.random()-1)],Object.assign({},state,feature);case actions.RECEIVE_DAY:return Object.assign({},state,feature);case actions.RECEIVE_FEATURES:return feature.properties.scatter=[75e-5*(2*Math.random()-1),75e-5*(2*Math.random()-1)],"sighting"===feature.properties.FeatureType&&(feature.properties.radius=2+2*Math.sqrt(feature.properties.Count)),Object.assign({},state,feature)}return state};exports.default=okavangoReducer},1092:function(module,exports){}});